var k=i=>{throw TypeError(i)},W=(i,t,e)=>t.has(i)||k("Cannot "+e),n=(i,t,e)=>(W(i,t,"read from private field"),e?e.call(i):t.get(i)),z=(i,t,e)=>t.has(i)?k("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),$=(i,t,e,s)=>(W(i,t,"write to private field"),t.set(i,e),e);const O=2147483647;var m;let E=class{constructor(t=!0){z(this,m,{width:0,height:0}),this.hd=t}get size(){return this.getSize()}set size(t){this.setSize(t)}getSize(){return n(this,m)}handleResize(t){this.size={width:window.innerWidth,height:window.innerHeight}}};m=new WeakMap;class b extends E{constructor(t,e,s,h=!0){super(h),this.el=t,this.ctx=t.getContext("bitmaprenderer"),this.setSize({width:e||window.innerWidth,height:s||window.innerHeight})}setSize(t){if(this.size.width===t.width&&this.size.height===t.height)return;this.size.width=t.width,this.size.height=t.height;const e=(this.hd?window.devicePixelRatio:1)??1;this.el.width=Math.round(this.size.width*e),this.el.height=Math.round(this.size.height*e),this.el.style.width=this.size.width+"px",this.el.style.height=this.size.height+"px"}static setCanvasStyle(t,e,s){const h=t.style,{zIndex:r=0,opacity:w=1}=e;h.position="fixed",h.top="0",h.left="0",h.zIndex=r.toString(),h.width=(s?s.width:t.width).toString()+"px",h.height=(s?s.height:t.height).toString()+"px",w!==1&&(h.opacity=w.toString()),h.pointerEvents="none"}}class D extends E{constructor(t,e,s=!0){super(s),this.offscreenCanvas=new OffscreenCanvas(this.size.width,this.size.height),this.ctx=this.offscreenCanvas.getContext("2d"),this.setSize({width:t||window.innerWidth,height:e||window.innerHeight})}setSize(t){if(this.size.width===t.width&&this.size.height===t.height)return;this.size.width=t.width,this.size.height=t.height;const e=(this.hd?window.devicePixelRatio:1)??1;this.offscreenCanvas.width=Math.round(this.size.width*e),this.offscreenCanvas.height=Math.round(this.size.height*e),this.hd&&this.ctx.scale(e,e)}to(t){t.ctx.transferFromImageBitmap(this.offscreenCanvas.transferToImageBitmap())}clear(){this.ctx.clearRect(0,0,this.size.width,this.size.height)}}var c,a;class L{constructor(t,e,s,h=!0,r={zIndex:0,opacity:1}){z(this,c),z(this,a),$(this,c,new b(t,e,s,h)),b.setCanvasStyle(n(this,c).el,r,{width:e,height:s}),$(this,a,new D(e,s,h))}get size(){return n(this,c).size}draw(t){n(this,a).clear(),t(n(this,a).ctx,{...n(this,a).size})}render(){n(this,a).to(n(this,c))}handleResize(t){n(this,c).handleResize(t),n(this,a).handleResize(t)}clear(){n(this,a).clear(),n(this,a).to(n(this,c))}}c=new WeakMap,a=new WeakMap;var I=i=>{throw TypeError(i)},B=(i,t,e)=>t.has(i)||I("Cannot "+e),f=(i,t,e)=>(B(i,t,"read from private field"),e?e.call(i):t.get(i)),F=(i,t,e)=>t.has(i)?I("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),H=(i,t,e,s)=>(B(i,t,"write to private field"),t.set(i,e),e),o;class q{constructor(){F(this,o),H(this,o,new Map)}add(t,e,s=window){f(this,o).has(s)||f(this,o).set(s,new Map);const h=f(this,o).get(s);h.has(t)||h.set(t,new Set),h.get(t).add(e)}startAll(){for(const[t,e]of f(this,o))for(const[s,h]of e)for(const r of h)t.addEventListener(s,r)}stopAll(){for(const[t,e]of f(this,o))for(const[s,h]of e)for(const r of h)t.removeEventListener(s,r)}clear(){f(this,o).clear()}}o=new WeakMap;function G(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function J(i){return!!i.touches}class d{static randomFloat(t,e){return Math.random()*(e-t)+t}static randomInt(t,e){return Math.floor(d.randomFloat(t,e))}static choice(t){const e=t.length,s=Math.floor(e*Math.random());return t[s]}static color(t="0123456789ABCDEF"){return"#"+d.choice(t)+d.choice(t)+d.choice(t)+d.choice(t)+d.choice(t)+d.choice(t)}}function K(i,{leftColor:t="#fff",rightColor:e="#444",leftBgColor:s="#35495e",rightBgColor:h="#00ffc0"}={}){console.log(`%c ${i} %c v0.6.0 6723769 %c`,`background: ${s}; padding: 2px; color: ${t}; font-weight: bold; text-transform: uppercase;`,`background: ${h}; padding: 2px; color: ${e}; font-weight: bold; text-transform: uppercase;`,"background: transparent")}function N(i,t,e){var s,h,r;e===void 0&&(e={});var w=(s=e.isImmediate)!=null&&s,u=(h=e.callback)!=null&&h,p=e.maxWait,x=Date.now(),g=[];function R(){if(p!==void 0){var l=Date.now()-x;if(l+t>=p)return p-l}return t}var C=function(){var l=[].slice.call(arguments),v=this;return new Promise(function(S,P){var T=w&&r===void 0;if(r!==void 0&&clearTimeout(r),r=setTimeout(function(){if(r=void 0,x=Date.now(),!w){var y=i.apply(v,l);u&&u(y),g.forEach(function(A){return(0,A.resolve)(y)}),g=[]}},R()),T){var M=i.apply(v,l);return u&&u(M),S(M)}g.push({resolve:S,reject:P})})};return C.cancel=function(l){r!==void 0&&clearTimeout(r),g.forEach(function(v){return(0,v.reject)(l)}),g=[]},C}export{L as S,O as a,K as b,q as g,d as i,N as r,J as v,G as w};
