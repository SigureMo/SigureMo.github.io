<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Computer Network | Notev</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/favicon152.png">
    <link rel="mask-icon" href="/icons/favicon152.png" color="#3eaf7c">
    <link rel="alternate" type="application/rss+xml" href="https://nyakku.moe/rss.xml" title="Notev RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://nyakku.moe/feed.atom" title="Notev Atom Feed">
    <link rel="alternate" type="application/json" href="https://nyakku.moe/feed.json" title="Notev JSON Feed">
    <meta name="description" content="一个小透明的透明世界">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta property="og:url" content="https://nyakku.moe">
    <meta property="og:site_name" content="Notev">
    <meta property="og:image" content="/bg.jpg">
    <meta property="og:description" content="一个小透明的透明世界">
    <meta property="og:title" content="Notev">
    <meta name="theme-color" content="#222222">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/favicon144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.1ff8ef7e.css" as="style"><link rel="preload" href="/assets/js/app.03ef6dba.js" as="script"><link rel="preload" href="/assets/js/19.5df00096.js" as="script"><link rel="preload" href="/assets/js/8.b1bbf589.js" as="script"><link rel="preload" href="/assets/js/20.770d2159.js" as="script"><link rel="preload" href="/assets/js/17.6e32e58c.js" as="script"><link rel="prefetch" href="/assets/js/1.11dbe83c.js"><link rel="prefetch" href="/assets/js/10.b0a00ebe.js"><link rel="prefetch" href="/assets/js/11.6c283ec5.js"><link rel="prefetch" href="/assets/js/12.b1dfd913.js"><link rel="prefetch" href="/assets/js/13.443a6689.js"><link rel="prefetch" href="/assets/js/14.e3cd8959.js"><link rel="prefetch" href="/assets/js/15.b05eb1cd.js"><link rel="prefetch" href="/assets/js/16.7723a294.js"><link rel="prefetch" href="/assets/js/18.eaf51443.js"><link rel="prefetch" href="/assets/js/21.88636573.js"><link rel="prefetch" href="/assets/js/22.1a89d11b.js"><link rel="prefetch" href="/assets/js/23.0cb3b1fa.js"><link rel="prefetch" href="/assets/js/24.21466c78.js"><link rel="prefetch" href="/assets/js/25.a2697258.js"><link rel="prefetch" href="/assets/js/26.d8f7bfec.js"><link rel="prefetch" href="/assets/js/27.3d194889.js"><link rel="prefetch" href="/assets/js/28.45cf9f9c.js"><link rel="prefetch" href="/assets/js/29.c7c10c36.js"><link rel="prefetch" href="/assets/js/30.843e0973.js"><link rel="prefetch" href="/assets/js/31.79bf490d.js"><link rel="prefetch" href="/assets/js/32.648409ae.js"><link rel="prefetch" href="/assets/js/33.15867297.js"><link rel="prefetch" href="/assets/js/34.9c9ed7c6.js"><link rel="prefetch" href="/assets/js/35.b788c9d5.js"><link rel="prefetch" href="/assets/js/36.48cade4d.js"><link rel="prefetch" href="/assets/js/37.67514b0a.js"><link rel="prefetch" href="/assets/js/38.c70c4eb1.js"><link rel="prefetch" href="/assets/js/39.9a2d4714.js"><link rel="prefetch" href="/assets/js/4.2b3f3ea5.js"><link rel="prefetch" href="/assets/js/40.ca915d24.js"><link rel="prefetch" href="/assets/js/41.13b9af1b.js"><link rel="prefetch" href="/assets/js/42.29f521b9.js"><link rel="prefetch" href="/assets/js/43.6264f405.js"><link rel="prefetch" href="/assets/js/44.2399ef40.js"><link rel="prefetch" href="/assets/js/45.929d7fd0.js"><link rel="prefetch" href="/assets/js/46.88a0ef59.js"><link rel="prefetch" href="/assets/js/47.1bfb5e58.js"><link rel="prefetch" href="/assets/js/48.3509b52f.js"><link rel="prefetch" href="/assets/js/49.945a4b66.js"><link rel="prefetch" href="/assets/js/5.b4470531.js"><link rel="prefetch" href="/assets/js/6.a11bb908.js"><link rel="prefetch" href="/assets/js/7.5f05a594.js"><link rel="prefetch" href="/assets/js/9.9d10aa72.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.c5ec94a3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1ff8ef7e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/bg.jpg);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          Notev
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/" class="navbar-link" data-v-e4145d0a>
            Home
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            Posts
          </a><a href="/friends.html" class="navbar-link" data-v-e4145d0a>
            Friends
          </a><a href="/about.html" class="navbar-link" data-v-e4145d0a>
            About
          </a><a href="https://github.com/SigureMo/notev" target="_blank" rel="noopener noreferrer" class="navbar-link" data-v-e4145d0a><span data-v-e4145d0a>GitHub</span> <span data-v-e4145d0a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          Computer Network
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2019-09-18
    </span> <span class="update-date" data-v-4e23451f>
      Updated : Invalid Date
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2019/08/21/data-structures-and-algorithms.html" class="post-link" data-v-4e23451f>
      Previous Post : Data Structures and Algorthms
    </a> <a href="/posts/2019/10/04/c-to-plusplus.html" class="post-link" data-v-4e23451f>
      Next Post : C to ++
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>《计算机网络》复习笔记</p></div> <h2 id="_1-计算机网络体系结构"><a href="#_1-计算机网络体系结构" class="header-anchor">#</a> 1 计算机网络体系结构</h2> <h3 id="_1-1-计算机网络概述"><a href="#_1-1-计算机网络概述" class="header-anchor">#</a> 1.1 计算机网络概述</h3> <h4 id="_1-1-1-计算机网络的组成"><a href="#_1-1-1-计算机网络的组成" class="header-anchor">#</a> 1.1.1 计算机网络的组成 <span class="badge error" style="vertical-align:top;" data-v-78fb0d1c>!</span></h4> <ul><li>组成成分
<ul><li>硬件</li> <li>软件</li> <li>协议</li></ul></li> <li>工作方式
<ul><li>边缘部分
<ul><li>C/S（包含 B/S）</li> <li>P2P（Peer to Peer）</li></ul></li> <li>核心部分 由路由器连接，进而实现分组交换</li></ul></li> <li>功能组成
<ul><li>通信子网</li> <li>资源子网</li></ul></li></ul> <h4 id="_1-1-2-计算机网络的功能"><a href="#_1-1-2-计算机网络的功能" class="header-anchor">#</a> 1.1.2 计算机网络的功能</h4> <ul><li>数据通信</li> <li>资源共享</li> <li>分布式处理</li> <li>提高可靠性</li> <li>负载均衡</li></ul> <h4 id="_1-1-3-计算机网络的分类"><a href="#_1-1-3-计算机网络的分类" class="header-anchor">#</a> 1.1.3 计算机网络的分类</h4> <ul><li>按分布范围的分类
<ul><li>广域网 WAN 基于交换技术</li> <li>城域网 MAN 基于广播技术</li> <li>局域网 LAN 基于广播技术</li> <li>个人局域网 PAN</li></ul></li> <li>按传输技术分类
<ul><li>广播式网络</li> <li>点对点网络</li></ul></li> <li>按拓扑结构分类
<ul><li>星形网络</li> <li>总线形网络</li> <li>环形网络</li> <li>网状形网络</li></ul></li> <li>按使用者分类
<ul><li>公用网</li> <li>专用网</li></ul></li> <li>按交换技术分类
<ul><li><a href="#_2-3-1-%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2">电路交换网络</a></li> <li><a href="#_2-3-2-%E6%8A%A5%E6%96%87%E4%BA%A4%E6%8D%A2">报文交换网络</a></li> <li><a href="#_2-3-3-%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2">分组交换网络</a> <ul><li>数据报</li> <li>虚电路</li></ul></li></ul></li> <li>按传输介质分类
<ul><li>有线
<ul><li>双绞线</li> <li>同轴电缆</li></ul></li> <li>无线
<ul><li>蓝牙</li> <li>微波</li> <li>无线电</li></ul></li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">节点与结点的区别</p> <ul><li>结点是指一个点，常用于数据结构</li> <li>节点是指一个实体，有处理能力，比如一台计算机、路由器</li></ul></div> <h4 id="_1-1-4-计算机网络的性能指标"><a href="#_1-1-4-计算机网络的性能指标" class="header-anchor">#</a> 1.1.4 计算机网络的性能指标</h4> <ul><li><p>速率（Speed）单位为 bit/s （bps）</p></li> <li><p>带宽（Bandwidth） 频带宽度，数字信道所能传送的“最高数据率”</p></li> <li><p>吞吐量（Throughtput）</p> <p>单位时间通过某个网络的数据量，受制于网络带宽和额定速率，也即其为<strong>实际值</strong>，带宽速率为额定值
另外其取决于整个链路中 <mark>吞吐量最低的链路</mark></p></li> <li><p>时延（Delay）发送时延 + 传播时延（ + 处理时延 + 排队时延） （后两者一般可忽略）</p> <ul><li>发送时延 <mark>分组长度 / 信道宽度</mark></li> <li>传播时延 <mark>信道长度 / 电磁波在信道的传播速率</mark></li> <li>处理时延 存储转发</li> <li>排队时延 队列等待，与网络中当前数据量相关，每增加一个中间 Node 就会增加一个发送时延</li></ul></li> <li><p>时延带宽积 <mark>传播时延 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">×</span></span></span></span></span> 信道带宽</mark>，即第一个分组到达下一个节点时候信道内的数据，可用于表征该通道可容纳的比特数量</p></li> <li><p>往返时延（RTT）</p></li> <li><p>利用率 利用率过高会产生非常大的时延</p></li></ul> <h3 id="_1-2-计算机网络的体系结构"><a href="#_1-2-计算机网络的体系结构" class="header-anchor">#</a> 1.2 计算机网络的体系结构</h3> <h4 id="_1-2-1-网络协议的概念"><a href="#_1-2-1-网络协议的概念" class="header-anchor">#</a> 1.2.1 网络协议的概念</h4> <p>三要素：语法 语义 时序</p> <h4 id="_1-2-2-网络体系结构的研究方法"><a href="#_1-2-2-网络体系结构的研究方法" class="header-anchor">#</a> 1.2.2 网络体系结构的研究方法</h4> <ul><li><p>层次 （layer）</p> <p>在计算机网络体系结构的各个层次中，每个报文都分为两部分</p> <ul><li>一是数据部分，即 SDU（服务数据单元）</li> <li>二是控制信息部分，即 PCI（协议控制信息）</li></ul> <p>他们共同组成 PDU（协议数据单元）</p> <blockquote><p>每层的协议数据单元都有一个通俗的名称，比如物理层的 PDU 称为比特</p></blockquote></li> <li><p>各层要完成的功能</p> <ul><li>差错控制</li> <li>流量控制</li> <li>分段和重装</li> <li>复用和分用</li> <li>连接建立和释放</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">分层的利弊</p> <ul><li>分层越少，各层协议越复杂</li> <li>分层越多，各层灵活性越好，易于标准化，所以 OSI 的标准使用了 7 层</li> <li>另一方面，分层越多，<strong>会使得有些功能在不同层中难免重复出现，产生额外的开销</strong>，导致整体运行效率越低，因此 OSI 仅仅是理想中的标准，很难投入商用</li></ul> <p>因此，层次的数量会取一个折中的方案</p></div> <h4 id="_1-2-3-协议、接口、服务"><a href="#_1-2-3-协议、接口、服务" class="header-anchor">#</a> 1.2.3 协议、接口、服务</h4> <ul><li>协议 规则的集合 <mark>对等实体</mark></li> <li>接口</li> <li>服务</li></ul> <h4 id="_1-2-4-层次模型"><a href="#_1-2-4-层次模型" class="header-anchor">#</a> 1.2.4 层次模型 <span class="badge error" style="vertical-align:top;" data-v-78fb0d1c>!</span></h4> <p>路由器只实现到网络层</p> <ul><li>OSI 七层协议
<ul><li>（物理媒体 （双绞线、光缆、无线信道等） 也被称为第 0 层）</li> <li><mark>物理层</mark> （Physical Layer）
<ul><li>传输单位 比特（bit）</li> <li>任务 透明地传输比特流</li> <li>功能 在物理媒体上为数据端设备透明地传输<strong>原始比特流</strong></li> <li>接口标准
<ul><li>EIA-232C</li> <li>EIA/TIA RS-449</li> <li>CCITT 的 X.21</li></ul></li></ul></li> <li><mark>数据链路层</mark> （Data Link Layer）
<ul><li>传输单位 帧（frame）</li> <li>任务 将网络层传来的的 IP 数据包组装成帧</li> <li>功能 <strong>成帧、差错控制、流量控制、传输管道</strong></li> <li>典型协议
<ul><li>SDLC</li> <li>HDLC</li> <li>PPP</li> <li>STP</li> <li>帧中继</li></ul></li></ul></li> <li><mark>网络层</mark> （Network Layer）
<ul><li>传输单位 数据报（datagram）</li> <li>任务 把网络层的协议数据单元（分组）从源端传到目的端，为分组交换网上的不同主机提供通信服务</li> <li>功能 对分组进行<strong>路由选择，流量控制、拥塞控制、差错控制、网际互联</strong>等</li> <li>典型协议
<ul><li>网际协议 IP （无连接）</li> <li>各种路由选择协议
<ul><li>IPX</li> <li>ICMP</li> <li>IGMP</li> <li>ARP</li> <li>RARP</li> <li>OSPF</li></ul></li></ul></li></ul></li> <li><mark>传输层</mark> （Transport Layer）
<ul><li>传输单位 报文段（TCP）或用户数据报（UDP）</li> <li>任务 负责主机中两个<strong>进程</strong>的通信</li> <li>功能 为<strong>端到端</strong>提供<strong>可靠</strong>的<strong>传输服务，流量控制、差错控制、服务质量、数据传输管理</strong>等</li> <li>协议
<ul><li>TCP （面向连接）</li> <li>UDP （无连接）</li></ul></li></ul></li> <li><mark>会话层</mark> （Session Layer）
<ul><li>任务 各个进程之间进行会话</li> <li>功能 建立同步</li></ul></li> <li><mark>表示层</mark> （Presentation Layer）
<ul><li>任务 处理在两个通信系统中交换信息的表示方式，采用标准的编码形式</li> <li>功能 <strong>数据压缩、加密、解密</strong></li></ul></li> <li><mark>应用层</mark> （Application Layer）
<ul><li>任务 提高用户与网络的界面</li> <li>典型协议
<ul><li>FTP</li> <li>SMTP</li> <li>HTTP</li> <li>DNS</li> <li>Telnet</li></ul></li></ul></li></ul></li> <li>TCP/IP 四层协议
<ul><li>网络接口层（OSI 物理层、数据链路层）</li> <li>网际层</li> <li>传输层</li> <li>应用层</li></ul></li> <li>五层协议
<ul><li>物理层</li> <li>数据链路层</li> <li>网络层</li> <li>传输层</li> <li>应用层</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>端到端和点对点的区别
<ul><li>数据链路层是<strong>点对点</strong> 主机到主机</li> <li>传输层是<strong>端到端</strong> 进程到进程</li></ul></li> <li>ISO/OSI 与 TCP/IP 辨析
<ul><li>ISO/OSI
<ul><li>网络层支持无连接和面向连接</li> <li>传输层仅支持面向连接</li></ul></li> <li>TCP/IP
<ul><li>网络层仅支持无连接的通信</li> <li>传输层支持无连接和面向连接</li></ul></li></ul></li></ul></div> <h2 id="_2-物理层"><a href="#_2-物理层" class="header-anchor">#</a> 2 物理层</h2> <h3 id="_2-1-通信基础"><a href="#_2-1-通信基础" class="header-anchor">#</a> 2.1 通信基础</h3> <h4 id="_2-1-1-基本概念"><a href="#_2-1-1-基本概念" class="header-anchor">#</a> 2.1.1 基本概念</h4> <ul><li>数据（Data） 传送信息的实体</li> <li>信号（Signal） 数据的电气或电磁表现
<ul><li>模拟信号</li> <li>数字信号</li></ul></li> <li>码元 指用一个固定时长的信号波形表示一位 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></span> 进制数字，比如八进制码元可以携带 3bit 的数据</li> <li>信源 产生和发送数据的源头</li> <li>信宿 接收数据的终点</li> <li>信道 信号的传输媒介，是<strong>逻辑通路</strong>，信道的极限容量是指新到的最高码元传输速率或信道的极限信息传输速率</li> <li>速率
<ul><li>码元传输速率 波特（Baud）</li> <li>信息传输速率 比特/秒（b/s）</li></ul></li> <li>带宽 原指信号具有的频带宽度，单位是赫兹（Hz），在实际网络中，常用来表示网络的通信线路所能传输数据的能力，表示单位时间内从网络中的某一点到另一点所能通过的“最高数据率”，此时带宽的单位不再是 Hz，而是 b/s</li></ul> <h4 id="_2-1-2-数据传输类型与通信方式"><a href="#_2-1-2-数据传输类型与通信方式" class="header-anchor">#</a> 2.1.2 数据传输类型与通信方式</h4> <ul><li><p>数字传输类型</p> <ul><li>模拟通信</li> <li>数字通信</li></ul></li> <li><p>通信方式</p> <ul><li>串行 并行</li> <li>单工 全双工 半双工<div class="custom-block tip"><p class="custom-block-title">单工、半双工、全双工的区别</p> <ul><li>单工 一条物理链路、一条信道，相当于单行道，只能向一个方向走</li> <li>半双工 一条物理链路、两条信道，相当于独木桥，两个方向都能走，但是不能向两个方向走</li> <li>全双工 两条物理链路、两条信道，相当于两个相反的单工合并而成的双车道，两条信道互不影响</li></ul></div></li></ul></li> <li><p>同步方式</p> <ul><li>同步 为解决时钟频率问题可以让发送方发送时钟脉冲，更好的方法是采用曼彻斯特编码</li> <li>异步 以字符为单位传输，前后分别加起始位和停止位</li></ul></li></ul> <h3 id="_2-2-传输介质"><a href="#_2-2-传输介质" class="header-anchor">#</a> 2.2 传输介质</h3> <h4 id="_2-2-1-主要类型"><a href="#_2-2-1-主要类型" class="header-anchor">#</a> 2.2.1 主要类型</h4> <ul><li>有线传输介质
<ul><li>双绞线</li> <li>同轴电缆</li> <li>光纤</li></ul></li> <li>无线传输介质
<ul><li>无线电波</li> <li>微波、红外线、激光</li></ul></li></ul> <h4 id="_2-2-2-物理层接口的特性"><a href="#_2-2-2-物理层接口的特性" class="header-anchor">#</a> 2.2.2 物理层接口的特性 <span class="badge error" style="vertical-align:top;" data-v-78fb0d1c>!</span></h4> <ul><li>机械特性 定义<strong>物理连接</strong>的边界点</li> <li>电气特性 规定传输二进制位时，线路上信号的<strong>电压高低、阻抗匹配、传输速率和距离限制</strong>等</li> <li>功能特性 指明某条线上出现的某一电平的电压表示<strong>何种意义</strong>，接口部件的信号线的<strong>用途</strong></li> <li>规程特性 主要定义各条物理线路的<strong>工作规程和时序关系</strong></li></ul> <h3 id="_2-3-交换技术"><a href="#_2-3-交换技术" class="header-anchor">#</a> 2.3 交换技术</h3> <p><img src="/assets/img/CN20.561151c4.png" alt=""></p> <h4 id="_2-3-1-电路交换"><a href="#_2-3-1-电路交换" class="header-anchor">#</a> 2.3.1 电路交换</h4> <p>在通话的全部时间内，通话的两个用户始终占用端到端的通信资源</p> <ul><li>优点
<ul><li><mark>时延小</mark></li> <li>有序传输</li> <li>没有冲突</li> <li>实时性强</li></ul></li> <li>缺点
<ul><li><mark>建立连接时间长</mark></li> <li>线路独占</li> <li>灵活性差</li> <li>难以规格化，<mark>难以差错控制</mark></li></ul></li></ul> <h4 id="_2-3-2-报文交换"><a href="#_2-3-2-报文交换" class="header-anchor">#</a> 2.3.2 报文交换</h4> <p>数据交换的单位是报文，携有目标地址、源地址等信息</p> <ul><li>优点
<ul><li>无需建立连接</li> <li>动态分配线路</li> <li>提高线路利用率</li> <li>提供多目标服务</li></ul></li> <li>缺点
<ul><li>转发时延较大（存储转发）</li> <li><mark>报文大小无限制，所以网络结点需要有较大的缓存空间</mark></li></ul></li></ul> <h4 id="_2-3-3-分组交换"><a href="#_2-3-3-分组交换" class="header-anchor">#</a> 2.3.3 分组交换</h4> <p>与报文交换一样采用存储转发的方式，但是进行了分块，再加上部分控制信息形成分组（Packet）</p> <ul><li><p>优点</p> <ul><li>无建立时延</li> <li>线路利用率高</li> <li><mark>简化了存储管理（相对于报文交换）</mark></li> <li>减少了出错概率（因为比较短）和重发数据量（因为出错时不需全部重传）</li></ul></li> <li><p>缺点</p> <ul><li>存在传输时延</li> <li>需要传输额外的信息量</li> <li>当采用 <mark>数据报</mark> 服务时，可能会出现 <mark>失序、丢失、或重复</mark></li> <li>当采用 <mark>虚电路</mark> 服务时，需要 <mark>呼叫建立、数据传输、虚电路</mark> 释放</li></ul></li> <li><p>两种方式</p> <ul><li>数据报
由于易于搭建，所以采用的更多
<ul><li>特点
<ul><li>不需要建立连接</li> <li>尽最大努力交付，可能发生失序、丢失、或重复</li> <li>对故障适应能力强</li> <li>资源利用率高</li></ul></li></ul></li> <li>虚电路
类似于地图的路线规划，同一链路可属于多个虚电路，不独占物理线路
<ul><li>携带的信息
<ul><li>虚电路携带路径、编号、路由表</li> <li>分组 HEAD 携带编号</li></ul></li> <li>特点
<ul><li>建立与拆除有开销，但是对长时间、频繁的数据交换效率较高</li> <li>路由选择体现在建立阶段，连接建立后，就确定了传输路径</li> <li>虚电路提供了可靠通信，能保证每个分组正确且有序到达，而且能进行流量控制</li> <li>致命弱点：某个节点发生故障后，经过该节点的虚电路都会崩溃</li> <li>虚电路是逻辑连接，非专用，每个节点到其他节点可有无数虚电路</li></ul></li></ul></li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">为什么数据报采用的更多</p> <p>有人参考电信网提出了虚电路的方法，这就需要提前建立链路，之后就可以进行比较可靠的传输了，但是计算机网络其实是有着很强的差错处理能力的，所以它并不需要过高的可靠性，可将错误处理等任务交由上层处理，这样有一个好处就是大大提升了网络层的灵活性</p></div> <div class="custom-block danger"><p class="custom-block-title">报文交换与分组交换相关计算</p> <p>主机甲通过 1 个路由器（存储转发方式）与主机乙互联，两段链路的数据传输率均为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mi>M</mi><mi>b</mi><mi mathvariant="normal">/</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">10Mb/s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">b</span><span class="mord">/</span><span class="mord mathdefault">s</span></span></span></span></span> ，主机甲分别采用报文交换和分组大小为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mi>k</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">10kb</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">b</span></span></span></span></span> 的分组交换向主机乙发送一个大小为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mi>M</mi><mi>b</mi><mo stretchy="false">(</mo><mn>1</mn><mi>M</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">8Mb(1M = 10^6)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 的报文，若忽略链路传播延迟、分组头开销和分组拆装时间，则两种交换方式完成该报文传输所需的总时间分别为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1600</mn><mi>m</mi><mi>s</mi><mo separator="true">,</mo><mn>801</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">1600ms, 801ms</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mord">0</span><span class="mord">1</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span></span></span></span></span></p> <p>传输图为：甲 -&gt; 路由器 -&gt; 乙</p> <p>未明确说明，不考虑排队时延和处理时延，又因为题中说明不考虑传播时延，所以只考虑发送时延</p> <ul><li><p>报文交换</p> <p>发送两次，第一次是甲，第二次是路由器，第一次全部发送完成第二次才开始进行，所以计算一次之后 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\times 2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">×</span><span class="mord">2</span></span></span></span></span> 即可</p> <p>每次都是 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mi>M</mi><mi>b</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>10</mn><mi>M</mi><mi>b</mi><mi mathvariant="normal">/</mi><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0.8</mn><mi>s</mi></mrow><annotation encoding="application/x-tex">8Mb / (10Mb/s) = 0.8s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">b</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">b</span><span class="mord">/</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">8</span><span class="mord mathdefault">s</span></span></span></span></span> ，所以一共 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1600</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">1600ms</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">0</span><span class="mord">0</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span></span></span></span></span></p></li> <li><p>分组交换</p> <p>同样是发送两次，但是前面的分组发送完成就可以到下一个节点了，所以甲的最后一个分组发送完成到达路由器时，前面的都已经走光了，最后一个分组可以直接再前往乙，而无需等待</p> <p>所以，一共应该是 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>800</mn></mrow><annotation encoding="application/x-tex">800</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span> 个分组在甲的总发送时延，再加上最后一个分组在路由器的发送时延，共 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>801</mn></mrow><annotation encoding="application/x-tex">801</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span><span class="mord">0</span><span class="mord">1</span></span></span></span></span> 个分组的发送时延，通过计算很容易得到 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>801</mn><mi>m</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">801ms</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span><span class="mord">0</span><span class="mord">1</span><span class="mord mathdefault">m</span><span class="mord mathdefault">s</span></span></span></span></span></p></li></ul></div> <h3 id="_2-4-数据编码技术"><a href="#_2-4-数据编码技术" class="header-anchor">#</a> 2.4 数据编码技术</h3> <ul><li>调制 数据变换为模拟信号
<ul><li>数字数据 -&gt; 调制器 -&gt; 模拟信号</li> <li>模拟数据 -&gt; 放大器调制器 -&gt; 模拟信号</li></ul></li> <li>编码 数据变换为数字信号
<ul><li>数字数据 -&gt; 数字发送器 -&gt; 数字信号</li> <li>模拟数据 -&gt; PCM 编码器 -&gt; 数字信号</li></ul></li></ul> <h4 id="_2-4-1-数字数据调制为模拟信号"><a href="#_2-4-1-数字数据调制为模拟信号" class="header-anchor">#</a> 2.4.1 数字数据调制为模拟信号</h4> <p><img src="/assets/img/CN17.62f2624d.png" alt=""></p> <ul><li>幅移键控 (ASK) 容易实现，但抗干扰能力差</li> <li>频移键控 (FSK) 容易实现，且抗干扰能力强，采用广泛</li> <li>相移键控 (PSK)</li> <li>正交振幅调制 (QAM)</li></ul> <h4 id="_2-4-2-模拟数据调制为模拟信号"><a href="#_2-4-2-模拟数据调制为模拟信号" class="header-anchor">#</a> 2.4.2 模拟数据调制为模拟信号</h4> <p>提高传输的效率，使用较高的频率，并使用频分复用技术，充分利用带宽资源</p> <h4 id="_2-4-3-数字数据编码为数字信号"><a href="#_2-4-3-数字数据编码为数字信号" class="header-anchor">#</a> 2.4.3 数字数据编码为数字信号</h4> <p><img src="/assets/img/CN18.a4a617c4.png" alt=""></p> <ul><li>非归零码（NRZ）
<ul><li>无检错功能</li> <li>难以同步</li></ul></li> <li>曼彻斯特编码 前一个间隔为高电平后一个间隔为低电平表示码元 1 ，反之为 0
<ul><li>优点
<ul><li>本身携带时钟周期</li> <li>消除直流分量</li></ul></li> <li>缺点
<ul><li>频率增加一倍，导致失真会严重，需要降低信道容量，原理参见 2.4.2</li></ul></li></ul></li> <li>差分曼彻斯特编码 前半个码元电平与上一码元电平的后半个码元电平相同，则为码元 1，反之为 0
<ul><li>优缺点同上，它的抗干扰性会稍好些</li> <li>常用于局域网传输</li></ul></li> <li>4B/5B 编码 4 位作为一组，按照规则转化为 5 位码， 5 位码共 32 种组合，其中 16 种为原来的 4 位码，另外 16 种作为控制码（帧的开始和结束等）</li></ul> <h4 id="_2-4-4-模拟数据编码为数字信号"><a href="#_2-4-4-模拟数据编码为数字信号" class="header-anchor">#</a> 2.4.4 模拟数据编码为数字信号</h4> <p>比如对音频信号进行的脉冲编码调制（PCM），需要进行<strong>采样、量化、编码</strong>三个步骤</p> <p>采样定理（奈奎斯特定理）：将模拟信号转换成数字信号时，假设原始信号中的最大频率为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span></span> ，那么采样频率 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">f_{sampling}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span> ，必须大于等于最大频率 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span></span> 的两倍，才能保证采样后的数字信号完整保留原始模拟信号的信息</p> <h3 id="_2-5-基带传输技术"><a href="#_2-5-基带传输技术" class="header-anchor">#</a> 2.5 基带传输技术</h3> <h4 id="_2-5-1-基带传输的定义"><a href="#_2-5-1-基带传输的定义" class="header-anchor">#</a> 2.5.1 基带传输的定义</h4> <p>脉冲波可以由傅里叶展开，分布在各个频率上</p> <h4 id="_2-5-2-信道的极限容量"><a href="#_2-5-2-信道的极限容量" class="header-anchor">#</a> 2.5.2 信道的极限容量</h4> <ul><li><p>奈奎斯特定理（奈氏准则） 理想低通（没有噪声、带宽有限）的信道中，极限码元传输速率为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>W</mi></mrow><annotation encoding="application/x-tex">2W</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span></span> 波特，其中 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span></span> 为理想低通信道的带宽</p> <blockquote><p>理想低通信道下的极限数据传输率 = <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>W</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>V</mi></mrow><annotation encoding="application/x-tex">2W \log_2 V</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></span> 单位为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi mathvariant="normal">/</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">b/s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord">/</span><span class="mord mathdefault">s</span></span></span></span></span></p></blockquote> <ul><li>在任何信道中，码元传输的速率是有上限的</li> <li>信道的频带越宽（即通过的信号高频分量越多），就可用更高的速率进行码元的有效传输</li> <li>但是如果不限制的增大频率，那么傅里叶展开的高频分量便增多，在信道上会被过滤掉的也更多，失真很大，很难恢复</li></ul></li> <li><p>香农定理 带宽受限且有高斯白噪声干扰的信道的极限数据传输率，当用此速率进行传输时，可以做到不产生误差</p> <blockquote><p>信道的极限信息传输速率 = <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">W \log_2 (1+S/N)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span> 单位为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi mathvariant="normal">/</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">b/s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord">/</span><span class="mord mathdefault">s</span></span></span></span></span>
信噪比 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>10</mn></msub><mo stretchy="false">(</mo><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">10 \log_{10} (S/N)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span> 单位为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">dB</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span></span></p></blockquote> <ul><li>信道中的带宽或者信噪比越大，信息的极限传输速率越高</li> <li>只要信息的传输速率低于新到的极限传输速率，就能找到某种方法来实现无差错的传输</li></ul></li></ul> <div class="custom-block danger"><p class="custom-block-title">计算中所需要注意的一些问题</p> <ul><li>奈氏准则 无噪声，出现码元离散电平数量 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>W</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>V</mi></mrow><annotation encoding="application/x-tex">2W \log_2 V</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></span></li> <li>香农定理 出现信噪比 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">W \log_2 (1+S/N)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span></li> <li>采样定理 采样频率 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msub><mo>≥</mo><mn>2</mn><mi>f</mi></mrow><annotation encoding="application/x-tex">f_{sampling} \geq 2f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span></span> ，其中 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span></span> 为最大频率</li></ul> <p>当两者都出现时，分别计算，取较小值</p> <ul><li>以太网采用<strong>曼彻斯特编码</strong>，而曼彻斯特编码的编码效率为 50% （每个比特需要两个电平），所以波特率是数据率的两倍</li> <li>相似地， 4B/5B 编码每 4 bit 被编码为 5 bit，编码效率为 80%</li></ul></div> <h3 id="_2-6-多路复用技术"><a href="#_2-6-多路复用技术" class="header-anchor">#</a> 2.6 多路复用技术</h3> <p><img src="/assets/img/CN19.09f39458.png" alt=""></p> <h4 id="_2-6-1-时分复用"><a href="#_2-6-1-时分复用" class="header-anchor">#</a> 2.6.1 时分复用</h4> <p>如果某个节点没有数据需要发送，那么信道资源会浪费</p> <p>这就衍生出来统计时分多路复用，需要增加标识 ID（地址）</p> <h4 id="_2-6-2-频分复用"><a href="#_2-6-2-频分复用" class="header-anchor">#</a> 2.6.2 频分复用</h4> <p>将整个带宽分为多份，用户在分配到一定的频带后，在通信过程中自始至终都占用这个频带</p> <h4 id="_2-6-3-波分复用"><a href="#_2-6-3-波分复用" class="header-anchor">#</a> 2.6.3 波分复用</h4> <p>波分复用就是光的频分复用，使用一根光纤来同时传输多个光载波信号</p> <h4 id="_2-6-4-码分复用"><a href="#_2-6-4-码分复用" class="header-anchor">#</a> 2.6.4 码分复用</h4> <p>每个站有一个 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mtext></mtext><mi>b</mi><mi>i</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">m\ bit</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace"> </span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span></span></span></span></span> 的码片序列，各节点码片序列正交，1 传原码 0 传反码</p> <p>代价：传输 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span></span> 倍数据，只能说使得信号可以分离，但并不能说效率增高了</p> <h3 id="_2-7-物理层设备"><a href="#_2-7-物理层设备" class="header-anchor">#</a> 2.7 物理层设备</h3> <h4 id="_2-7-1-中继器"><a href="#_2-7-1-中继器" class="header-anchor">#</a> 2.7.1 中继器</h4> <p>又称<em>转发器</em>，主要功能是将信号整形并放大再转发出去，提高传输距离</p> <p>有两个端口（一个输入，一个输出）</p> <p>没有存储转发功能，不能连接两个速率不同的网段，两个网段一定要使用同一个协议</p> <div class="custom-block tip"><p class="custom-block-title">中继器与放大器的异同</p> <p>都起放大作用，但</p> <ul><li>放大器，放大模拟信号，是对衰减信号的放大</li> <li>中继器，放大数字信号，是将衰减信号整形再生</li></ul></div> <h4 id="_2-7-2-集线器"><a href="#_2-7-2-集线器" class="header-anchor">#</a> 2.7.2 集线器</h4> <p>集线器（Hub）实质上是一个多端口的中继器，当其有多个端口输入时，输出会发生冲突，致使这些数据都无效</p> <p>每个端口连接的网络部分都是同一个网络的不同网段，只能在半双工状态下工作，不能划分冲突域，工作效率很低</p> <h2 id="_3-数据链路层"><a href="#_3-数据链路层" class="header-anchor">#</a> 3 数据链路层</h2> <p>数据链路层的功能</p> <ul><li><p>为网络层提供服务</p> <ul><li>无确认的无连接服务 如以太网</li> <li>有确认的无连接服务 如无线通信</li> <li>有确认的面向连接服务</li></ul></li> <li><p>链路管理</p> <div class="custom-block tip"><p class="custom-block-title">链路与数据链路的区别</p> <ul><li>链路 无源点对点的物理线路段</li> <li>数据链路 物理链路+通信协议</li></ul></div></li> <li><p>帧定界、帧同步与透明传输</p></li> <li><p>流量控制</p></li> <li><p>差错控制</p></li></ul> <h3 id="_3-1-三个基本问题"><a href="#_3-1-三个基本问题" class="header-anchor">#</a> 3.1 三个基本问题</h3> <h4 id="_3-1-1-封装成帧"><a href="#_3-1-1-封装成帧" class="header-anchor">#</a> 3.1.1 封装成帧</h4> <p>既要加首部，又要加尾部，数据部分长度需要小于 MTU</p> <p>另外还需要考虑<strong>帧定界</strong>问题</p> <ul><li>字符计数法 就是用一个计数字段来标志帧内字符数</li> <li>字符填充的首尾定界符法 用特定字符来标志帧的开始与结束，为了防止帧内出现控制字符导致帧定界出现问题，所以需要对帧内的控制字符进行转义</li> <li>比特填充的首尾标志法 并不是按字符来定界，而是直接以比特形式定界，使用 <code>01111110</code> 来标志一个帧的开始与结束，为了防止内容中出现的 <code>01111110</code> 被当做开始与结束标识符，可在发送时将信息中每五个连续的 <code>1</code> 之后插入一个 <code>0</code> ，接收方相反，那么就不会出现上述问题了，因为，该方法很容易使用硬件来实现，所以性能更优</li> <li>违规编码法 由于曼彻斯特编码方法将数据编码为”高-低“电平对（1）和”低-高“电平对（0），并不存在”高-高“电平对和”低-低“电平对，所以……我们就可以用这个搞事情啦，比如定界</li></ul> <h4 id="_3-1-2-透明传输"><a href="#_3-1-2-透明传输" class="header-anchor">#</a> 3.1.2 透明传输</h4> <p>就是前面所述的，为了保证数据的透明传输，在封装成帧的时候不能在数据中出现控制字符需要转义，但对发送端与接收端来说，这个过程是透明的，数据就像从来没改变过一样</p> <h4 id="_3-1-3-差错检测"><a href="#_3-1-3-差错检测" class="header-anchor">#</a> 3.1.3 差错检测</h4> <p>比特差错 利用循环冗余检验(CRC)</p> <p>帧的丢失、重复、失序并不能检测出来，故不是可靠传输</p> <h3 id="_3-2-使用点对点信道的数据链路层"><a href="#_3-2-使用点对点信道的数据链路层" class="header-anchor">#</a> 3.2 使用点对点信道的数据链路层</h3> <p>用于广域网</p> <h4 id="_3-2-1-点对点协议-ppp"><a href="#_3-2-1-点对点协议-ppp" class="header-anchor">#</a> 3.2.1 点对点协议 PPP</h4> <ul><li>简单</li> <li>提供差错检测但不提供纠错</li> <li>只支持全双工</li> <li>面向字节</li></ul> <p>PPP 帧信息段长度范围为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1500</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1500]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span> ，因为它并不需要 CSMA/CD 协议，没有最短帧长的问题，但要小于 MTU</p> <div class="custom-block tip"><p class="custom-block-title">为什么 PPP 帧不需要 MAC 地址就能送到</p> <p>因为 PPP 协议是点到点的，而以太网是总线型且是广播帧，所以以太网发送帧需要标明发送给谁，而 PPP 帧逻辑上只有发送端和接收端在点对点通信，自然没有这个问题啦</p></div> <h4 id="_3-2-2-高级数据链路控制-hdlc"><a href="#_3-2-2-高级数据链路控制-hdlc" class="header-anchor">#</a> 3.2.2 高级数据链路控制 HDLC</h4> <ul><li>使用编号和确认机制，能够提供可靠传输</li> <li>面向比特</li></ul> <div class="custom-block tip"><p class="custom-block-title">为什么现在大多使用 PPP 而不是 HDLC</p> <p>在通信线路质量较差的年代，HDLC 更加流行，因为它能提供可靠传输，但是随着通信线路质量的提高，数据链路层实现可靠传输变得没那么必要，所以可以使用将可靠传输交由上层处理，比如 TCP</p></div> <h3 id="_3-3-使用广播信道的数据链路层"><a href="#_3-3-使用广播信道的数据链路层" class="header-anchor">#</a> 3.3 使用广播信道的数据链路层</h3> <p>用于局域网</p> <h4 id="_3-3-1-局域网的拓扑"><a href="#_3-3-1-局域网的拓扑" class="header-anchor">#</a> 3.3.1 局域网的拓扑</h4> <ul><li>星型网 中央节点出问题全网瘫痪</li> <li>环形网 类似链表，节点插入与删除较麻烦</li> <li>总线网 较为方便，采用较多</li></ul> <p>三种特殊的局域网拓扑实现：</p> <ul><li>以太网 逻辑拓扑是总线形结构，物理拓扑是星形结构</li> <li>令牌环 逻辑拓扑是环形结构，物理拓扑是星形结构</li> <li>FDDI 逻辑拓扑是环形结构，物理拓扑是双环结构</li></ul> <p>下面的局域网大多讨论的是以太网</p> <h4 id="_3-3-2-介质访问控制"><a href="#_3-3-2-介质访问控制" class="header-anchor">#</a> 3.3.2 介质访问控制</h4> <p>因为以太网是半双工通信，需要共享信道，这就需要寻求比较好的媒体共享技术</p> <ul><li>静态划分信道
前面所述的<a href="#_2-6-%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E6%8A%80%E6%9C%AF">多路复用技术</a>，包含频分、时分、波分、码分，但是代价较高，不适合局域网使用</li> <li>动态媒体接入控制
<ul><li>随机接入 用户可随机地发送信息，但是如果两个或更多的用户同时发送的话，会发生碰撞，所以需要解决碰撞的协议，常用协议如下
<ul><li>ALOHA 协议
<ul><li>纯 ALOHA 协议 想发就发，冲突重发</li> <li>时隙 ALOHA 协议 将时间划分为一段段等长的时隙，只有在每个时隙的开始才能发送</li></ul></li> <li>CSMA（载波侦听多路访问）协议 发送前侦听一下共用信道，根据侦听结果做不同的反应
<ul><li>1-坚持 CSMA
<ul><li>如果信道空闲，则发送</li> <li>如果信道忙，则等待，同时<strong>继续侦听直至信道空闲</strong></li> <li>如果发生冲突，那么随机等待一段时间后，再重新开始侦听信道</li></ul></li> <li>非坚持 CSMA
<ul><li>如果信道空闲，则发送</li> <li>如果信道忙，则放弃侦听，<strong>等待一个随机的时间后侦听</strong></li></ul></li> <li>p-坚持 CSMA
<ul><li>如果信道空闲，则以概率 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></span> 发送数据，以概率 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1-p)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></span> 推迟到下一个时隙（下一个时隙需要重新侦听）</li> <li>如果信道忙，那么<strong>等待下一个时隙再侦听</strong></li> <li>如果发生冲突，那么随机等待一段时间后，再重新开始侦听信道</li></ul></li></ul></li> <li>CSMA/CD 协议 <strong>以太网</strong>采用，在下节内详述</li> <li>CSMA/CA 协议 <strong>无线局域网</strong>采用，在无线局域网章节详述</li></ul></li> <li>受控接入 用户不能随机发送信息，需要受到一定控制，比如<strong>令牌环局域网</strong>的令牌传递协议，拿到令牌才能发送数据</li></ul></li></ul> <h4 id="_3-3-3-以太网与-ieee-802-3"><a href="#_3-3-3-以太网与-ieee-802-3" class="header-anchor">#</a> 3.3.3 以太网与 IEEE 802.3</h4> <ul><li><p>数据链路层的两个子层</p> <ul><li>逻辑链路控制 LLC （作用基本消失，大多网卡已不装该协议）</li> <li>媒体接入控制 MAC</li></ul></li> <li><p>以太网的传输介质</p></li></ul> <table><thead><tr><th>参数</th> <th>10BASE5</th> <th>10BASE2</th> <th>10BASE-T</th> <th>10BASE-FL</th></tr></thead> <tbody><tr><td>传输媒体</td> <td>基带同轴电缆（粗缆）</td> <td>基带同轴电缆（细缆）</td> <td>非屏蔽双绞线</td> <td>光线对（850nm）</td></tr> <tr><td>编码</td> <td>曼彻斯特编码</td> <td>曼彻斯特编码</td> <td>曼彻斯特编码</td> <td>曼彻斯特编码</td></tr> <tr><td>拓扑结构</td> <td>总线形</td> <td>总线形</td> <td>星形（逻辑拓扑仍为总线网）</td> <td>点对点</td></tr> <tr><td>最大段长</td> <td>500m</td> <td>185m</td> <td>100m</td> <td>2000m</td></tr> <tr><td>最多结点数目</td> <td>100</td> <td>30</td> <td>2</td> <td>2</td></tr></tbody></table> <ul><li><p>网络适配器
又称网络接口卡，是局域网中连接计算机和传输介质的接口，每块网卡出厂时都有唯一的代码，称为 MAC 地址</p> <ul><li>作用
<ul><li>串并转换</li> <li>数据进行缓存</li> <li>需要驱动程序</li> <li>实现以太网协议</li></ul></li></ul></li> <li><p>CSMA/CD 协议（载波侦听多路访问/碰撞检测协议）</p> <p>先听后发，<strong>边听边发</strong>，冲突停发，随机重发</p> <ul><li>如果信道空闲，则开始发送，并同时侦听信道
<ul><li>如果在传输过程中检测到了来自其他适配器的信号能量，则需停止该帧的传输，取而代之传输一个 48bit 的拥塞信号以<strong>强化碰撞</strong> <ul><li>在中止后，适配器采用截断二进制指数退避算法等待一段随机时间后重新侦听</li></ul></li></ul></li> <li>如果信道忙，则持续侦听直到信道上没有信号能量</li></ul> <hr> <ul><li>由于 CSMA/CD 的站不可能同时进行发送和接收，所以采用 CSMA/CD 的以太网不可能使用全双工，只能使用<strong>半双工</strong></li> <li>由于一个站在发送数据后最多经过 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>τ</mi></mrow><annotation encoding="application/x-tex">2\tau</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span></span></span></span></span> （两倍的总线端到端传播时延）就可以知道自己的数据是否发送成功，所以可以将其称为<strong>争用期</strong>，经过 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>τ</mi></mrow><annotation encoding="application/x-tex">2\tau</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span></span></span></span></span> 如果没检测到碰撞，那么就可以确定帧已经到达目的站了</li> <li>因为一个站发送最多发送 64B （以太网争用期为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>51.2</mn><mi>μ</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">51.2 \mu s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">.</span><span class="mord">2</span><span class="mord mathdefault">μ</span><span class="mord mathdefault">s</span></span></span></span></span> ，10Mb/s 的以太网）就能知道是否冲突，所以如果发生冲突，发送的帧一定小于 64B ，那么便可以将其作为<strong>最短帧长</strong>，小于该长度的帧直接丢弃即可</li> <li>为了能够更大程度地降低冲突的概率，<strong>截断二进制指数退避算法</strong>使用争用期的 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span></span> （<span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>≤</mo><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r \leq 2^k - 1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span> 且为整数，从中随机选一个）倍作为冲突重传的退避时间</li> <li>另外以太网还规定了<strong>帧间最小间隔</strong>，为了使刚刚收到数据帧的站有清理缓存的时间</li></ul></li> <li><p>以太网的 MAC 层</p> <p>适配器检查源地址和目的地址，如果是发往本站的帧则收下，否则丢弃</p> <p>数据部分长度范围为 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>46</mn><mo separator="true">,</mo><mn>1500</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[46, 1500]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">4</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span> B，下限 46B 是因为最小帧长为 64B ，除去 MAC 首部和尾部的 18B ，最少为 46B，而上限 1500B 是规定的 MTU</p> <div class="custom-block tip"><p class="custom-block-title">没特别做透明传输机制的原因</p> <ul><li>曼彻斯特编码，可识别有无信号</li> <li>帧间有间隔</li></ul></div></li> <li><p>如何提高以太网的信道利用率</p> <ul><li>减小 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span></span></span></span></span></li> <li>增大帧长，但不能超过 MTU</li></ul></li> <li><p>高速以太网</p> <p>速率达到或超过 100Mb/s 的以太网</p> <ul><li>100BASE-T 以太网 双绞线，星形拓扑，既支持半双工又支持全双工</li> <li>吉比特以太网 既支持半双工又支持全双工</li> <li>10 吉比特以太网 光纤，全双工</li></ul></li></ul> <h4 id="_3-3-4-无线局域网与-ieee-802-11"><a href="#_3-3-4-无线局域网与-ieee-802-11" class="header-anchor">#</a> 3.3.4 无线局域网与 IEEE 802.11</h4> <ul><li><p>分类</p> <ul><li><p>有固定基础设施无线局域网</p> <p>比如蜂窝移动电话</p> <ul><li>组成
<ul><li>基本服务集 BSS</li> <li>接入点 AP</li> <li>扩展的服务集 ESS</li></ul></li> <li>与接入点 AP 建立关联
<ul><li>被动扫描</li> <li>主动扫描</li></ul></li></ul></li> <li><p>无固定基础设施无线局域网自组织网络</p> <p>临时自组的，每个结点都有路由功能</p></li></ul></li></ul> <ul><li><p>CSMA/CA 协议（载波侦听多路访问/碰撞避免协议）</p> <p>因为无法检测碰撞，故使用<strong>退避算法</strong>以降低碰撞几率
只有第一帧且信道空闲不执行退避算法，此外全部需要使用退避算法</p> <hr> <ul><li>三种碰撞避免机制：
<ul><li>预约信道</li> <li>ACK 帧 CRC 校验，并返回确认帧（ACK 帧），若未收到则重传</li> <li>RTS/CTS 帧（可选，用于解决隐蔽站问题）</li></ul></li> <li>解决隐蔽站和暴露站问题
<ul><li>虚拟载波监听</li> <li>想发送数据前先发送 RTS（包含时间），接受站发送 CTS（包含时间）</li> <li>短数据帧代价有点大，不使用也可</li></ul></li></ul></li> <li><p>802.11 局域网的 MAC 帧</p> <ul><li>数据帧
<ul><li>要有序号，以配合确认机制</li> <li>除去传输帧站点 MAC 和接收帧站点 MAC，还需要一个真正的源地址或者目的地址（emmmm，也不一定，有路由器的话就不是真正的咯）</li> <li>没有冲突检测，故数据部分不需要够 46 字节</li> <li>分片机制，不限制 MTU 可以增加灵活性，在信道质量好的时候可以传输长一些，而质量差的时候进行分片传输短的数据帧；整个帧的占用时间是所有分片占用时间的加和</li></ul></li> <li>控制帧</li> <li>管理帧</li></ul> <div class="custom-block tip"><p class="custom-block-title">CSMA/CD 和 CSMA/CA 的主要区别</p> <ul><li>CSMA/CD 基本思想是发送前侦听，发送时也侦听，如果<strong>发现碰撞马上停止发送</strong></li> <li>CSMA/CA 基本思想是发送前先广播告知其他节点，让其他节点在某段时间内不要发送数据，<strong>以免出现碰撞</strong></li></ul></div></li></ul> <h4 id="_3-3-5-令牌环网的基本原理"><a href="#_3-3-5-令牌环网的基本原理" class="header-anchor">#</a> 3.3.5 令牌环网的基本原理</h4> <p>令牌（Token）在令牌环网中传递，拿到令牌才能发送数据</p> <p>物理上采用星形拓扑，但逻辑上仍是环形拓扑</p> <h3 id="_3-4-数据链路层设备"><a href="#_3-4-数据链路层设备" class="header-anchor">#</a> 3.4 数据链路层设备</h3> <p>如果在物理层使用集线器扩展以太网的话，会使得碰撞域更大，吞吐量并未提高，而且需要各碰撞域使用相同数据率</p> <p>所以，<strong>网桥</strong>出现了，可以使用它在数据链路层扩展以太网，且不会扩展碰撞域</p> <ul><li><p>什么是网桥？
<strong>网桥的接口就是节点</strong>
没有扩展碰撞域，用户独占带宽</p> <ul><li>功能 连接网络 1 和网络 2 后，网桥接收网络 1 发送的数据帧，检查数据帧中的地址，如果是网络 2 的地址，那么就转发给网络 2 ，否则就将其丢弃，因为源站和目的站处在同一个网段，目的站能够直接收到这个帧而不需要借助网桥转发</li> <li>优点
<ul><li>用户独占带宽</li> <li>网桥两端可以使用不同数据率</li></ul></li> <li>缺点
<ul><li>存储转发时延</li> <li>无流量控制</li> <li>广播风暴</li></ul></li></ul></li> <li><p>透明网桥（选择的不是最佳路由）</p> <ul><li>利用<strong>自学习算法</strong>，可以根据帧的源地址和来源接口建立表，同时记录一个有效时间，以保证各节点变化时可以继续正常工作</li> <li>使用生成树算法避免兜圈子</li></ul></li> <li><p>源路由网桥（选择的是最佳路由）</p> <p>路由选择是由发送数据帧的源站负责的，为了找到最佳路由，源站以广播的方式发送一个发现帧，该帧将会通过多个路径到达目的站，目的站一一应答，源站便可从应答帧中得出最佳路由</p></li> <li><p>以太网交换机</p> <ul><li>就是<strong>多接口的网桥</strong>，每个接口都直接与主机相连，一般是全双工</li> <li>星型拓扑，不需要 CSMA/CD，不需要竞争资源，效率更高</li> <li>自学习功能 建立一张交换表，通过接收的帧来建立表，这样如果之后来的一个帧目的地址能查到，则按照表内项转发，如果<strong>查不到</strong>，则<strong>向除来源端口的所有端口广播该帧</strong></li></ul> <div class="custom-block tip"><p class="custom-block-title">以太网交换机能划分广播域吗？</p> <p>以太网交换机只能划分冲突域，不能划分广播域，但是可以借助交换机方便地实现 VLAN ，VLAN 是可以划分广播域的</p></div></li></ul> <h2 id="_4-网络层"><a href="#_4-网络层" class="header-anchor">#</a> 4 网络层</h2> <h3 id="_4-1-网络层的功能"><a href="#_4-1-网络层的功能" class="header-anchor">#</a> 4.1 网络层的功能</h3> <h4 id="_4-1-1-网络层提供的两种服务"><a href="#_4-1-1-网络层提供的两种服务" class="header-anchor">#</a> 4.1.1 网络层提供的两种服务</h4> <p>数据报或者虚电路</p> <h4 id="_4-1-2-虚拟互联网络"><a href="#_4-1-2-虚拟互联网络" class="header-anchor">#</a> 4.1.2 虚拟互联网络</h4> <p>因为各个网络间有着各种各样的协议等等问题，而要做到各个网络标准完全一致又是不可能的，因此网络之间的互连就成了一个问题</p> <p>一般来说，各层间的中间设备分别是：</p> <ul><li>物理层： 转发器</li> <li>数据链路层： 网桥</li> <li>网络层： 路由器</li> <li>网络层以上： 网关</li></ul> <p>由于我们讨论的是网络层，所以在该层上看，转发器与网桥对网络的互连其实仅仅是将一个网络扩大了，还是在一个网络上；所以我们讨论网络的互连一般指路由器对网络的互连</p> <h4 id="_4-1-3-路由与转发"><a href="#_4-1-3-路由与转发" class="header-anchor">#</a> 4.1.3 路由与转发</h4> <ul><li>路由选择 根据路由选择算法，生成路由表</li> <li>分组转发 转发（forwarding）是将分组从一个输入链路接口转移到正确的输出链路端口，需要根据路由表，生成转发表，并进行转发</li></ul> <h3 id="_4-2-网际协议-ip"><a href="#_4-2-网际协议-ip" class="header-anchor">#</a> 4.2 网际协议 IP</h3> <h4 id="_4-2-1-ipv4-分组"><a href="#_4-2-1-ipv4-分组" class="header-anchor">#</a> 4.2.1 IPv4 分组</h4> <ul><li><p>IPv4 分组的格式</p> <p><img src="/assets/img/CN24.e6ebae0d.png" alt=""></p> <ul><li>版本 IP 的版本 占 4bits，当前广泛使用 IPv4</li> <li>首部长度 占 4bits，<mark>以 4Bytes 为单位</mark>，值范围 5~15，也即 20Bytes 固定首部，40Bytes 可选部分</li> <li>总长度 占 16bits，<mark>以 1Byte 为单位</mark>，范围为 0~65535Bytes
<blockquote><p>由于低于 46 字节的填充是在网络层完成而不是数据链路层，可由总长度区分数据与填充部分</p></blockquote></li> <li>标识（identification） 占 16bits，计数器
<blockquote><p>事实上较新的标准中，当 DF=0 时是不关心标识的，此时直接置 0 是更好的方案（在我的一次 HTTP/1.1 抓包实验中通讯双方虽然都使用 DF=0，但在 ID 字段的设置上分别使用了直接置 0 和计数器的方案）</p></blockquote></li> <li>标志（flag） 占 3bits，标志分片信息
<ul><li>第一个 bit 为 0</li> <li>第二个 bit 为不分片标志（DF，Don't Fragment），为 0 时表示不可分片</li> <li>第三个 bit 为更多分片标志（MF，More Fragment），为 1 时表示非最后一个分片，为 0 时表示其为最后一个分片</li></ul></li> <li>片偏移 占 13bits，<mark>以 8Bytes 为单位</mark> ，分片后的相对位置
<blockquote><p>标识、标志、片偏移三个字段的存在可以保证分片可以正常组装，标识位区分是否是同一个帧的分片、标志标明是否使用分片和分片是否到了最后一片、片偏移标志了顺序（字节为单位）</p></blockquote></li> <li>生存时间 TTL 占 8bits，表示在互联网中最多被转发的次数，每一跳都会自减一</li> <li>协议 占 8bits，决定交由上层哪个协议
<ul><li>1: ICMP</li> <li>2: IGMP</li> <li>6: TCP</li> <li>8: EGP</li> <li>17: UDP</li> <li>41: IPv6</li> <li>89: OSPF</li></ul></li> <li>首部校验和 占 16bits，每经过一个路由器都要改变一次</li> <li>源 IP 地址 占 4Bytes</li> <li>目的 IP 地址 占 4Bytes</li></ul></li> <li><p>IP 数据报分片</p> <p><img src="/assets/img/CN21.b73624fe.png" alt="copyright:Wangdao"></p></li></ul> <p>需要注意各个长度的最小单位，比如这里片偏移以 8B 为单位，所以，除最后一个片外，其它所有片中的有效数据载荷都是 8 的倍数</p> <ul><li><p>网络层转发分组的流程</p> <p>得到目的主机 IP 和网络地址后，需要经过以下四次匹配</p> <ul><li>与直接相连各网络地址匹配（如果匹配上则为直接交付，否则就是间接交付）</li> <li>特定主机路由匹配</li> <li>网络匹配</li> <li>默认路由查询
<blockquote><p>默认路由是将所有未知网络聚合成一个表项</p></blockquote></li></ul> <p>若最终也没找到，则抛出错误，具体流程如下</p> <blockquote><p>如果多项匹配，应按照<strong>最长前缀匹配</strong>转发，这样转发是最优的路径</p></blockquote></li></ul> <div class="vuepress-flowchart loading"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 30 30" class="vuepress-flowchart-loading-icon" style="enable-background:new 0 0 50 50;"><rect x="0" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0s" dur="0.6s" repeatCount="indefinite"></animate></rect> <rect x="10" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0.15s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0.15s" dur="0.6s" repeatCount="indefinite"></animate></rect> <rect x="20" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0.3s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0.3s" dur="0.6s" repeatCount="indefinite"></animate></rect></svg></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>得到下一跳路由器的 IP 地址后并不是直接将该地址填入待发送的数据报，而是将该 IP 地址转换成 MAC 地址（通过 ARP），将其放到 MAC 帧的首部中，然后根据这个 MAC 地址找到下一跳路由器</p> <p>在不同网络中传送时，MAC 帧中的源地址和目的地址要发生变化，但是在网桥转发帧时，不改变帧的源地址，比如下面这两个例子</p> <ul><li>AB 经网桥相连（<code>A -&gt; bridge -&gt; B</code>）
<table><thead><tr><th>源 IP</th> <th>目的 IP</th> <th>源 MAC</th> <th>目的 MAC</th></tr></thead> <tbody><tr><td>A</td> <td>B</td> <td>A</td> <td>B</td></tr> <tr><td>A</td> <td>B</td> <td>A</td> <td>B</td></tr></tbody></table></li> <li>AB 经路由器相连（<code>A -&gt; router -&gt; B</code>）
<table><thead><tr><th>源 IP</th> <th>目的 IP</th> <th>源 MAC</th> <th>目的 MAC</th></tr></thead> <tbody><tr><td>A</td> <td>B</td> <td>A</td> <td>router</td></tr> <tr><td>A</td> <td>B</td> <td>router</td> <td>B</td></tr></tbody></table></li></ul></div> <h4 id="_4-2-2-ipv4-地址和-nat"><a href="#_4-2-2-ipv4-地址和-nat" class="header-anchor">#</a> 4.2.2 IPv4 地址和 NAT</h4> <ul><li><p>结构</p> <p>网络号+主机号，可加快转发效率（先只匹配网络号）</p> <p>一个网络号在整个网络范围内是唯一的，一个主机号在该网络内也是唯一的，所以一个 IP 地址在整个互联网范围内是唯一的</p> <blockquote><p>可是专用网是可以的？因为专用网 IP 并不出现在网络上呀，只会在机构内部出现</p></blockquote></li> <li><p>分类</p> <p>根据前几位可分为以下 5 类</p> <ul><li>A 类 <code>0</code> （1Byte 网络号，3Bytes 主机号）</li> <li>B 类 <code>10</code> （2Bytes 网络号，2Bytes 主机号）</li> <li>C 类 <code>110</code> （3Byte 网络号，1Byte 主机号）</li> <li>D 类 <code>1110</code> 多播</li> <li>E 类 <code>1111</code> 保留</li></ul> <div class="custom-block tip"><p class="custom-block-title">一些具有特殊用途的 IP 地址</p> <ul><li><strong>主机号全为 0</strong> 表示网络本身</li> <li><strong>主机号全为 1</strong> 表示本网络的广播地址，又称<em>直接广播地址</em></li> <li><strong>32 位全为 0</strong>，即 <code>0.0.0.0</code> 表示本网络上的本主机</li> <li><strong>32 位全为 1</strong>，即 <code>255.255.255.255</code> 表示整个 TCP/IP 网络的广播地址，又称<em>受限广播地址</em></li> <li><strong>127.x.x.x</strong> 即网络号为 127，主机号为除全 0 或全 1 的任意地址，保留为<strong>环路自检地址</strong>，此地址表示任意主机本身
<blockquote><p>大多数主机（Hosts 文件）默认把 localhost 指向 <code>127.0.0.1</code></p></blockquote></li></ul></div></li> <li><p>网络接口与 IP 地址的关系</p> <p>当一台主机同时连接到多个网络时，该主机就必须同时具有多个相应的 IP 地址，每个 IP 地址的网络号必须与所在网络的网络号相同，所以每个网络接口都对应着一个 IP 地址</p></li> <li><p>网络地址转换（NAT）</p> <blockquote><p>专用 IP 地址仅仅在机构内部使用，是不可能出现在网络上的</p></blockquote> <ul><li><p>三个专用 IP 地址块（RFC 保留的地址）：</p> <ul><li>10.0.0.0 - 10.255.255.255</li> <li>172.16.0.0 - 172.31.255.255</li> <li>192.168.0.0 - 192.168.255.255</li></ul></li> <li><p>虚拟专用网 VPN</p> <p>利用公用的互联网作为本机构各专用网之间的通信载体，由于通过公用的互联网，所以数据必须加密</p> <p>利用隧道技术（通过公用网的时候，将专用网内 IP 数据报封装入数据部分，首部写入公网 IP 等信息）</p> <p><img src="/assets/img/CN02.12f58c2c.png" alt=""></p></li></ul></li></ul> <ul><li>路由器上有一个 IP 的转换表，在传输层有对<strong>端口号</strong>的管理，从而确定路由器发送到哪个内部节点</li></ul> <blockquote><p>普通路由器在转发 IP 数据报时，并不会改变源 IP 地址和目的 IP 地址，而 NAT 路由器在转发 IP 数据报时，一定要更换其 IP 地址</p></blockquote> <ul><li><p>IP 地址的一些重要特点</p> <ul><li>是一种分等级的地址结构</li> <li>每个接口都有一个 IP，所以，有多个接口接入网络的主机会是多归属主机</li> <li>用转发器或者网桥互连是在同一个网络（同一个广播域），路由器才能连接不同网络</li> <li>同一网络号所有 IP 是平等的</li></ul></li></ul> <h4 id="_4-2-3-子网和超网的基本概念"><a href="#_4-2-3-子网和超网的基本概念" class="header-anchor">#</a> 4.2.3 子网和超网的基本概念</h4> <p>传统的分配方法会造成 IP 地址的浪费</p> <ul><li>子网 将大的网络分成几个较小的网络 IP = 网络号 + 子网号 + 主机号
<ul><li>由于从 IP 数据报中无法知道该主机所连接的网络是否进行子网划分，所以使用子网掩码对 IP 地址的子网部分进行标记</li> <li>网络号与子网号均置 1，主机号置 0</li> <li>判断两主机是否在同一子网，只需要 IP 与子网掩码与运算就好啦，但是两个节点的子网掩码不同可能导致判断不同的，所以可能会出现 A 认为 B 和自己在同一子网，而 B 认为 A 和自己不在同一子网的情况</li></ul></li> <li>超网 无分类域间路由 CIDR
<ul><li>不进行 ABC 的分类，只需要网络前缀即可(相当于只有子网掩码)</li> <li>可利用斜线记法表示，对应掩码 1 的个数</li> <li>路由聚合（路由聚合有利于减少路由器之间的路由选择信息的交换，从而提高了整个互联网的性能）</li></ul></li></ul> <h3 id="_4-3-internet-的路由选择协议"><a href="#_4-3-internet-的路由选择协议" class="header-anchor">#</a> 4.3 Internet 的路由选择协议</h3> <h4 id="_4-3-1-路由算法分类"><a href="#_4-3-1-路由算法分类" class="header-anchor">#</a> 4.3.1 路由算法分类</h4> <ul><li>全局性/分布式</li> <li>静态路由选择策略（手工配置与调整）/动态路由选择策略</li></ul> <hr> <ul><li>分层次的路由选择协议
将整个互联网划分为一个个小的自治系统 AS，AS 内使用内部网关协议，AS 间使用外部网关协议
<ul><li>内部网关协议 IGP
<ul><li>RIP</li> <li>OSPF</li></ul></li> <li>外部网关协议 EGP
<ul><li>BGP</li></ul></li></ul></li></ul> <h4 id="_4-3-2-路由信息协议-rip"><a href="#_4-3-2-路由信息协议-rip" class="header-anchor">#</a> 4.3.2 路由信息协议 RIP</h4> <ul><li>基本特点
<ul><li>分布式</li> <li><strong>距离向量算法</strong></li></ul></li> <li>路由表的建立
<ul><li>开始只知道相邻的路由信息（距离为 1）</li> <li>每个路由器只和相邻路由器交换并更新路由信息</li> <li>若干次更新后……该自制系统的路由信息就都知道了</li> <li>RIP 协议收敛过程比较慢</li></ul></li> <li>RIP 的工作过程
<ul><li>收到相邻路由器的路由表，将<em>该路由表</em>的下一跳更新，距离加一，该更新是无条件的（因为这不是最终的路由表，更新保证了时效性）</li> <li>与自己的路由表比较，小则替换，大则 pass</li> <li>若 3min 收不到该路由器的路由表，则判断该路由器宕掉了</li></ul></li> <li>三个要点
<ul><li>相邻路由器交换</li> <li>交换的信息是当前路由器所知道的<em>全部信息</em></li> <li>按固定的时间间隔交换路由信息（30s）</li></ul></li> <li>优缺点
<ul><li>坏消息传的慢：某个路由器的故障信息传播较慢</li> <li>实现简单，开销较小</li> <li>限制了网络的规模使用的最大距离为 15</li> <li>路由器之间交换的路由信息是完整的路由表，随着网络规模增大，开销将会增加</li></ul></li></ul> <h4 id="_4-3-3-最短路径优先协议-ospf"><a href="#_4-3-3-最短路径优先协议-ospf" class="header-anchor">#</a> 4.3.3 最短路径优先协议 OSPF</h4> <p>开放分布式、<strong>链路状态路由算法</strong></p> <ul><li>基本特点
<ul><li>开放</li> <li>最短路径优先 （ Dijkstra 算法）</li> <li>分布式的链路状态协议</li></ul></li> <li>三个要点
<ul><li>向本自治系统所有路由器发送信息</li> <li>发送与本路由器相邻所有路由器的链路状态（与谁相连与链路的度量（就是权重，比如带宽、时延等））</li> <li><strong>只有链路状态变化时才需要更新</strong></li></ul></li> <li>链路状态数据库
<ul><li>就是储存的<strong>拓扑结构</strong>信息</li></ul></li> <li>OSPF 的区域
<ul><li>如果自治系统很大，那么需要<strong>对自治系统划分为一个个区域（area）</strong></li> <li>每个区域有一个 32 位标志符（点分十进制）</li> <li>区域不能太大，最好一个区域不超过 200 个路由器</li> <li>两种区域：主干区域、其它</li></ul></li> <li>OSPF 直接用 IP 数据报传送
<ul><li>不用 UDP，直接用 IP 数据报，而 RIP 是需要先封装成 UDP 协议的</li> <li>数据报很短，可减少路由信息的通信量</li> <li>不需要分片</li> <li>但分片传送的数据包只要丢失一个就无法组装成原来的数据报，整个数据报要重传</li></ul></li> <li>其他特点
<ul><li>可以根据不同链路的类型计算不同的路由</li> <li>多路径间的负载平衡</li> <li>所有在 OSPF 路由器之间交换的分组都具有鉴别的功能</li> <li>支持可变长度的子网划分和五分类编址 CIDR</li> <li>每个链路状态都带上一个 32 位的序号</li> <li>OSPF 每隔一段时间要刷新链路状态</li></ul></li> <li>OSPF 的五种分组类型
<ul><li>问候</li> <li>数据库描述</li> <li>链路状态请求</li> <li>链路状态更新</li> <li>链路状态确认</li></ul></li> <li>OSPF 的基本操作
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArMAAAEgCAAAAACClqS3AAAABGdBTUEAALGPC/xhBQAAAAJiS0dEAP+Hj8y/AAAAB3RJTUUH5AYLCAMPrMGefwAAIMhJREFUeNrtnfufVNWZ7l3vu6obNF6i0N3AnMzkzESlGySCOSIg4CgCteu2G02MfOacMydBoLvaSRSR6gIkGmUSTLRLrOrOaIIB4i0I9KUaiA6GV/+u5/yw9q5LX7h2VVd1v8/no9aq3lXVvdbXt5619n72ug0qVXPpNu0ClTKrUimzKpUyq1JmVSplVqVSZlXKrEqlzKpUyqxKmVWplFmVSplVKbPzQBfHixM1fnGe9cH4pD4YH1dmG1KZXwEovlM1WO+PzasuyB4YB/BaNbCj4w37+85vZseLxQvhw/8sFovF4q+LxWLx9f0laIvF4pzvghKdg8VisVjsLxaLxWLmABq1D26b38S678DS4AAoFl89WxqrcVwszmlqS34gfOIsgEpgi0XgQoP1wW3znthisVjMHCyN0cFycanQPOiCTOnZsbHG7oP5y2zVbKPyyUmDNWeZnfJPHA/6o3H7QJktFZp3UMwWi8XMkSOvHT58+PDro+PzitlisZh5FfhDplgcO+C64PAfx5TZRv1iLGYOhcOYmWpEx+dmF1yo6oJfjod/d39j98G8ZTbjBiSLo5mSlRsvViAL9JcrTGYOd0EGf8pkfjlcprTijx2t6IN+ZXa2ByxzHhiv+MarqrvBCth4f7E4DpzPZJ6Zg8pkPgUuFIt/uarBHXV98Fm/Mjv7zGYy5wCMT/1NWV64xflMZq4ym8l8PL1ZqLSwn/RnlNmGYLY8ZpNOXAbnLS98Ehw3V5nNZDIfjE/dBWEfFP+rP5Pp7+/PzBtm/UCN06piNpPJZI6dmepcbfHMsYpj5jCzmUwm8/bQlMsCY4NhH/T3z6M62wTMhsPyu1D9k384x5kN9dbbgQ5Xdkx/pn9eMXvrOvunGnqD69UctkfXUH9Jyux16+2Xa/Gu/dczXKVHh+cis/03RGzmNWX2BtzFLFWZ/kx/f8DtnJ6HXheyjVNmm4PZz2ZxxOYwstfRBY2IbBMwO+j7b9XmnS9cx4hlMpn+ccxZXbheZBupDxqf2fJUvwY6038NP9t/BnNc5/uvRW12uLF+43nOLAAMH5tmuI4NY55o7O1pwM0ea8CYUcMze9L3fb9Q+88ZHzt/7NixY8eO/fa3vz03No75qLGxd48Fyo01biau4Zl9ya95oVU1lxqeWV+ZVTWbn4USq1JmG0iJxSgwMzMvAJBYoEQqs42uFvtv7kFkAYDIIuCsQ/gLZVOZbUCdjSxGy+Iys3l+pjMJAIi3KJrKbCPqXGRx6XFkARDnM51LrKuz/H8VTmW2MZmNWWbmf0dkAc5ZPtOZgE0olsps4zLbhtjtQJ5/hshCeMxnOuN5V2bvUjabmNm5q3ORNni3A3m7C5GF6GE+0xl7+m708FntHGW2YZmN3g7keTciC/B5H5/pXGJfUGaV2cZm1lpr7R5EFgCFyjnYHu0fZbYx52DRO8rrBgU+0+kBvbzK085pcGa/oWRF61FzKph8ERGRMcYQEb2IVJ8b3Y7gwDURAECKpEk7//yEta48n+n0cJZ3Y0VB0WxQZk+RMWYfNph9FU+mTGrSgbQUgGWZxGwyMjeYLfAiIM9ngS/YA87yoLLZqHXWpoCsMcYYC4BMWXYSs6e5o4LZ0+tXUQSRe5Hi5mV2EQBgu7W8AI7ZPLsSa9XPNiizp8xJZE0bcNrsA0DlCrveAmAiIpMKmMVapJicWLLrV0VeIyJiIm5abBtBr756Upm9fqXom282B9WVvpn0Y14CnC4zCwD4S2B+s8+uiSBJ0sTeoEG0LxaLJX+vzF7v5MuYCHgfUm04Td+cNpU6PYHZFHMKQDZgNvnsmgiwsjZzsFjN5N2gYnVSPB7vP6vMXk+ZbT9Zwax78nR5DjahztoUgNXkoE3+sYbrBo3DrFc/ZuNHzyuz19RBx2zZG2TNyWswe9qte4XrBpHQ3upX/E3rpVgsFts1pN7gOgvthDqbskDgEH45NbMR+ggR+o+QWUD97K0z+8onOge7IWb/Eq5wfQNYW+0NyBiiSmZb6CMAq+lEBbNaZHWtq87Mvmb+jFQbTptvkDXm5YneAEBpfTbVzx8BAFZ3aJ1VZmdrEuYKbKoNWfMNqP2Aefn05PNgf6EUcJqZl1Y+q8wqs7NSZwH4QKotaVJItbvlL6eXwmMMkQWQWorTzO6kAvMvgDURJINzDJxq0v6PLkbB2jB3G21VIhue2XmvlvAcbSl3+4XmbpXZxtX5yGK0LCozm+fuLncVYlRzt03NbCo1d5ltKz2OLACi/Neu77Fe8938zPpzmlnPWssuW3PO8l87PUT0gu/mZ3ZO5269ch4synymy3tfc7fKbIMze0eJ2V7mM13elnvQqxlGZbaRvcHtQJ5fQGQBPnkxyN328jklU5ltSA1H2uBZZnbMIs9flHO3LyicymzjaSyyGN7t5XWDPJ/tjAE9vCamZCqzDanxSbnbc50xjPMurMgrmspsI+pimdm8y92OAxc5BlxkhVaZbURdCpj1gssN8nwR+YDWyM8UTmVWpczOB2bHD6eUEWW2eZgd6k4mk0llRJm9Qe17xfdf2Vf3j5VjSafE9IrH4/F4vPLx1K1E+XH81nXtz7v+1iQpszOh7lnZ007e9a+T2akAnvCjRCIRjyfi8ZtntuqF037eTbSU2VrouO/7fnY2Pvnsz5PqDZTZm7Ozvv+3WfrsK28os8rszTGr46RqJmbf8P19Ok6qZmL2777/oY6TqpmY1fNgqqZjdp8yq2oyZj99R4dJNfPMyrTyA91C68qMvMt1tFKpVMq1UqlUKpVMJl0rOL0QtML19+layWled7V3uf4ja9Ka8OmpVLknrr8Hb1xzmNn6tWaC2WTTM5ua78zeuk78XlRzUnOX2cO/0NFVZpuL2Zv/7lEps7PC7BXfL+jwKrPNxOx/+n5Wh1eZbSZmu/05bw4KZArK7Bxi1vd9/0oTD8yqQjcX3twu3ZQSESlwVjaEG6B+HhzD5nBAL/siefblKB0WkaMdIiLyBA91R5XZpmH2Xd/3/Tebd1zyHPX5+HI78jgNhsyubxcRkfX8uawnIiJjjCEiXwrs58MtfckXyx2O2TctR5XZZmG275ZWrRtA3X43Z9qzYomItj5MRE8/XMnsoMgOE/yBG4hou+S5W96kwyIiP/jfu8J7KPMflNkmYdZvcma7mZmJ2n0alPX2nBQ4K+vK3mAdDYqsK9nZAndLJbNBqeZB9bO6PltHPc5cEOmkrHR1OG+wrl1kh7MK6yhBRMYQEfGwY7akTczb3X9+HVdmldm6KRLZ7hxqSuzTIgXKBiaWiLbJOhoUpnPrHMGS525ZHvzQXpD3ebvIryKWmQ8ps8psnbTRlx1ceIbYPp3nrEiBacuayjo7uI4OSplZ+uGixZLnbtloxx2z1t/Ev7b2ojKrzNZLOzgrIu+s7/DtOVlHlJWVWyqYLXSG3uA+eZBohyxvlzyVmP27tZc28eARuluZVWbrVGfdHMyXN4m2BGtddvtKIiLaItLFX4iIWz4QkTztkAdCbzAu7/MdzIdkEw3KZk4qs8psnaC15+QZyopYSjlmC3Rg5VMisvIpka5lMonZDsnTDnncFuV93v73uMhGGhSJaZ1VZuujPHPkED8tkmeigkiBs8/Yj1c+KSIPPSWD5HWV1g1oh+Rph9zfIXkOmd3marWudSmz9dRyZs5Knv082y+kwJkVT8oKIiJ6Sp4J6mtlnb0/9AZjYpm3ytyVMtuwfjYrb7gam2f/WbIfdw1K17+KyIon5Zkn3VGPOWafJSrI/e4ig8ft2I+3ijxYOg+mflaZVQXavfsdZVaZbS5mY7FY4pAy2+TMxm5VFfeLrXrec4pGvWg0Go261sRXTHiRV61YrfTiB8qsMjs9ftHoVZmNTc9srHY68Jkyq96gabxB7CdH1Rsos03EbPo9nYMpsyplVqXMKrMNJM3dKrMNpVWFHVx482l5hku52/Cab/40OIbNkYDeMFvzG5e7bRMRkU081L1VmVVm66Q8b/P5+HL71w1cKDEbXMzFnzp8g9gtdUuBu0u5W/avWG4TEdnMb9m5eOGBMtug6u7xuX9RViwz85ZVRLRl1ZKA2c+myN1ukzz7csxlGO/P7NbcrTJbb2QdcG1JHpQN9gvJV3qDgNn1Fbnb4J4cx6pzt3OPV2W2kbWJuSCynLPSGeRu1y8pZWvWU6w6d1v5x250lyJuZn7LU2abidnwjtNNKhvZzsxEnBS7pXoORk/Lepe7XV+Ru30wvH62KHneJvJGxDJXlF1lVpmtcZVNSTcXdrCtyN0+vESkO6yzg+vpYPmab6aV7W2SZ182hcza1GZ6S3O3TcVss6vb5W43tCftWVlPlJWuLSLdNOSYLeduF8kDRL482BEwOy7v87a/W3txMw0eoXuUWWW2bm6WiSglv67I3W7rKuduz7oFgym8gcvd0iHZTIPyBCWUWWW2Ptpo/yo7XO42KUHutn/FhNxtiVnqdrlb5w3e521/j4lspkERT+usMlsf5ZkjB6tztzvsx2FWfJCiXUTlm3dWMLuxnLvdTJq7VWbrqTB3mwxyt/0rnyrlboMVr6o6e3953cCyg3aOSpltUGtQlbtNPuNytyueFJGVT8qOJ91Rwf26nqnI3W60Y89uE7nfnZMgZvWzTcVsgUj3rtE6W09mH/uJiIi0/IOIiKwNvvsOikjrUpEfDO3koSMbZCf/WIKJdXiIm1SLSHlNvcBLRUQiLeMikrfWWusqkV0QrmC2dsxYrx5/KaFozUdm3zfufHrLsuCJtXRQRKR12XDrUhm0657n9/55waVHeajErLt5+1o+K4+VpyjESZFnOSUiz/FGEZG83Vj6lO8vuCiykw+KtDIz861v0HQ0GY/H44rWvKyzh8z3Kpk9RMvk4LKQWdn58vOcuTMrLczMG1Yx0cYfhsx+IY9RQeTHlAqrLDPzEvlnd6XTNMwuufXu/PRgfGrNTO42eo3c7axkxWOxmDJb0porjwWXiBL9l7TQoKyl9V+1Lh1uXSo73Vf7PzzHQ/LogmK1Nxh2zD4W2tkCb5Q8L93Bh0S+z3/I243PW2Zmy/0zyuzXRxIzwmxsutj3JGbjDZAVV2YnVVtaLyIiOwMg/8MxK7KWeUjkXzgrP1hW9gY/cVPpxyhe8gZ21DHLHLkQMltRZy/8MPS2zMzOHd+CBnbG1RvMV2bXGbNBRHYGzIaMHQmYbVm40UH2rLRuqJ6D0WZ5jArCPL423F1ro+R5qTwvIt9vHZ/kDWZYH+5XZudpnT1uNojIPxGtC57YGSwaDLculbU/lZ08tJNbI48PWnfh0+OrK+tsYS1lpcQsM/NSeS4eMnu5xTKz3Rgw+ztPPrKPz+zigWq+MnvIENFzk5kV2clZEfnjo8t+snBcHmXKStemSmbDjVxoSVhn9zMfKjG7VERaN8r3Wy+K7GQ+/ZF9XOT7iqwye8vMRsxBaaGfihxyAC4bccw+6ozBc3KEeUOw1mWf6gqsgXTZMbc8VuUNjjMXJjK74KLstBtFPrKPX2muKqtZ8YZk9oo1B0XkH93KbFWdXbvgkiu1LfxjCS58ynRtEpGuzSJd35MpmJW1hyu9gXXe4G17UEQ+src+/5pB/bDQPW1WPLyn2+SsuMuD/cZlxTfzkK9Z8Xqvz2543hwUEZF/XDaR2UHLCw/bDSKDlnlIpMDZ5/jzkNkCP7m84pxCgTc5ZkWqvEHlHGwnL2mgccnzVp+PL7efbuDSHs3rKnO3QVg8zIr7mhVvBGYPGeNOKpTkmBV37lb+JzNnZdD+eNAuGJcCH+jaJKE3eDZYmZ0wBxMRaemoOg/WskRE5H8xb2ysgenu8bm/rTorvqyC2atmxR88UM6KDymzdVzr+p4cMqVzCj8NF7KGdhLRQXmUOStH3JgM2mefp8iZrkHp2uzq7LObpJrZzZLnZXKcmVvHy8w+bC1/KDut3dho4+JXZcU/r/YGwb7i6yZnxX9TnRWfe7w2xzmF+apNpT2aS1nxjooM49Wz4ttEZDOTZsWV2TrKZcWZOOn2aL5GVtyvzIPleZvI6xFLpFlxZbZu2pyUbi7soKqseEdF7nZSVnxxW2XuVrPiyuwsTMJcVvzx9qT963RZcarIii+fmBW/tJl0j2Zltq5ulokoOU1WvHNiVtzXrLgyO9vaaM9Nzoq73O2WKbLivjzQIe9Tuc5qVlzvfVRnVWXFBzUrrsw2gzQrrsw2mTW4elb8KXfUNbPirFlxZValzCqzTSvdV1yZbTpmdV/xucDsDO7RHGuarLjuK67MNl1WXPcVV2/QRN5A9xWfUel+tzVnVvcVV2ZVyqxKmVVmG0qaFVdmG0pX21f8OrPiuq+4MltP3WhWXPcVV2ZnXd09PmduPiv+gu4rrszWWUFWvP0Gs+LH6LWKUq1ZcWW2rppiX/FyVnzddWXF+ahmxZXZ+mmKrPiGclZ8HQ0K0/kwd1uYIiv+RsQys2bFldl6aXNSfC50k7VbC6WseNt0+4oXmFa2t5dyt3neLmKTT/Bb1l5SZpXZ+jnaUlb8vGwgykrnlhKzG6iwPPQG7UFWPLy/wQXJ8/Yr1l56ggd/RXcqs8psffSE20YxKb8mejpY67LbO4mIaKtIJ4+6cjtU8gbhfSDtmOT5O8yHZTMPyZOarVFm62YOIiPS7bLiCQmy4ge6topI11aR5e6GkWVmU67OpmSTLUqeo1fiIk/wkEhM66wyWx/lLUcO8naRQikr3s2fhswWKFa+vS6l3BzMMbvZMetqta51KbP1VCczZ6XAyQLbYSnwK11bg9vrbg1drWwI6myefXmgKiselbkrZbZBrQFzVt50WfECJ7vJftY1KGGd7Q5uXxDc36CbaFAeCC4ysBd2RCuz4kllVplVKbPKrEqZnXVm3/9FUtFSZm9Qfb2+39s7K116NJVIJJRZZfZG1e37/ixU2o8PJpPJZGJahaHu6VuTj42XA+RXVSL451ovu/7fZepWIlH1ayYSiYQyOxP6je/7/qv1RvarI6mrM5uYCpuq1k0j6157Daan+IQbbyUSE5BVZmfKzvr+rKSlBn6STKo3UGZvktnZ6tQP9ieVWWX2hnXQ93t1eJXZZmL2j77/ex1eZVbXZ1XKbA3Vq8wqs03G7MCbOrrKbHMxK1d0dJXZmWd2OvmBmqOVSrlWKpVKJZPJpGslA7lWuPo+861kovx5tfmE6VqVf18ymUymUmFP3EgPol5qAmavfFg3gmeV2USjMJua38zOhF5/ESpVUzFbx/+DVcrsDDF7WcdJ1UzMHvf9fh0nVTMx2+2rOVA1F7P+/GM2lgMArDRfK6DNyOxp3/f9d5uvY3OcA98F5HgAAJiZrcBy6M3T/DXwNe29vLBEqnGo4rJheCbUQPjTAfR2KLDNwOwv/OYstDG+jB4eQA9/DQAcR8xeeYCZmSMlZnO016PIRGaRNolJdTZmBmBuM0psEzDrNymzzHzX3/gedzuNAXAcMWa+G8hxDH2RErNI/x/kwk0VjDHGXAYe/joXtjqQLpXc224rlV1ltsGpbcJ+7QlMwH87a+Dq7I4+3gNrgcu8J82XHbOhuswKk6h6j5XmcrnhlaqwMqvM1sgaMPvMP8txNw+U/WwscAbL70nzK+EGNQMA0EUDyJl2R685WKqtJo6cAeCZ3QB644qsMlsjfZXjAXzJP4/dORBUWhsH0szMnAPSkQR/BaTJBg42eECmHUDa/Hfle32w0lyGZ9qBtNmsyCqztVs3GMDfOOVmXV/l7Fc2dpE5B2A57wWQ5i8Bj+hLAB61AfB6XJHdi7T5CqG93euMATxjBtJGy6wyWzM9yMz3FPnnwWJXzn5p+a6Kn6eZ/wbYTUt6wmcukmkDLi0EkDZfgtoAIGcCw/tQ4BNUymxN6+wF9l2d3Z2zl2wMsMzMHDy4hBz1ePcBgNc2QD3w3gU8sxdIm0sI7WyPq7PGmIzDWKXM1pDZIu8q1dkLNgbYGAAbg8d3pfkCvAiKlAPA9kXa1cUAQASkzeqPTVBnexyxi7eb3EWzWIFVZmvILB2Nj1Z4g/FKZnM5pHk8xz1A1yKgj3py9ALS5oWusV6zF2ljLoR1thdRYxYFa13GXFJkldna1VlmZh4JWnbMMr/hvIEHAH28j+8FMEqL0GeRox4AI6bt/FKgy4wgrLNpwALACjMCIG16lFlltkbqpQHYrwJyd3vMPABYD8G/0Mf3tAYFudcxaYwxZgQAcjnAtGHEGONO1uaMMb01+1VfeunPyqwy21R6KRaPJ3+vzDa5YjMmr0aKzbDi8fiBs8qsMttczMaPDiuzqibxBrFYbNeQegNVEzH7yic6B1OplFmVqmGYfaQDAE6ZEzoWqkZl9lteEjxqoW+BRzrQEl53dwJ3AqfCXbZfRorLsvZPACL3AkDLAgCADcTMtjV8+5ZFOqjK7EyrdSGArDGmFV9OqLNJ04JTtA8ATtHLwfG2pfTSA/ZFAFnrrsmz5UvzVrcCOMwfAC3MzPyBjqwyO1M66Wro/qyD9GTr/6D2rUF+rwNIUmt2emYj1lr7Xay21lp7ZRpmG6XO5igHvrMUFrfMbL+C5bHg5308BoxSz2gpLB4NI1/l1KIxxuSA8+a+4Jjg7K4yW1dobwcS+xEwe/CRVR0AcDL0s49OWWeXB8wmgch3D9gPgdX2Cmz8kLWWreUPGpBZj0bQyzn08igAWA+eHa8Ii/fxGJCjnmgpLB6tjin2VWRsjQHQZ4whfKjM1vsDs7T/FLUia4whSmz/j0c6DpRy0kkH60RmmTlVZtbaBQiZrayzcWsr7O/+We9ZJvrOMN8RhsWtBy8Mi3voi4TM7kX6Z3ivMituRpCrKLMDYau3T4Pis8JswnmDjgPmxEnaj0dOPDLx3igVc7BSnY04aF2dxQEAqxdM9rMNpR5yX+Ij7Iqn9eDZHX28FzbyJca4J6yzpVesMJ0muFVxzvQGdTZtckDOAF4vlNlZm4MlFgDIOmaBRzqQDIpMB4DkN0CSvu2n8tqXbQEe5n1lP5v9ZYnZFsvW2ljA7GcvByC33Dv71oCJfeZdOfZ5oOxnvcAZPPjdNL8ahsVzDtkB5NxVsxOZ7TO9OWPQZ4wxxlNm624NiIgo0W++LTPrimSkA/iWWqdkFg/bP4V19kNrPywxex+Allg4B+NvYOPA6tlHFiM5ymGEd3t3lMLiXhgWHwD6WuI8BvSFZjZtGABApg2Y4A2i7sHdfWZgoIaX0Sqz02nNkq0LASTMtyfNK6U6G64bZCgJRFowiVk8/N2SNyhae3kKZg/buFsAa4AqC7deMMLJB5mZeSxnx6w3yjwAYDn3hHOwKNEogGhFWPwh04OBUp0N/IDn5mDK7Gww+y3vTyzsp7dbWnHSTK6zEfoWJ2kf+ukE+MSktS7HLGLlOmtt6A0+tx8EM7b9jdCxK5n57mF+oRQIG7P8ncpVAeYxwG5YWjK0I8YsBoZbgSpmc4EnMF6fGVFmZ2UOdiKx8M8PHqAEpvCzp0wHsKYFjtmXp2O2PAdruW/CHOwwN8z6LA9ghFOdzMy8J2fHrBeGxYMHY8hRT/Q+AIi25UwPogNA1PQAA1XeAGvviLrbHw0rs7PA7K9+hMTt+JboBCb52SQeMSewhj4CTtK+U/zRJGbdHAwAWu6rWjdwdiDO3Dh3rXDM/ryiznrlQJjHd6V5DNEIRikHgLjP7HmIAMAQgGEzgGjoDc6b3qjpM78zBGV2VtYN1lAC6O9ANbNJY8xHwKNI0rcAYInvxjR1tmjdGm3IbMwyCw5b21C3Wcnxb2LV3qCC2VwOaR7LUQ/QdR+Qpp73zG6kzQurRly0dptZXDrlFTUDUTPwL2njKbOztNY1TzRVWPz1qrD4/lJYPM3u7hsYMW3DSwB3zsuQe+0v/hVRg2F3eiGtPavMXlWfHk7e7EurwuJ7opPC4ulyWDxYLyiFxbcH0fC+8HqDHxkP6PsOlFll9uoa2hGPxxPaD8psc2jsWCIRn07Xnbm9hdRttO7J21gsFlNmm1cX3k3NBLM3DWw0Gr0WtjFlVjVRp9Jx9QbKbLPp/OvKrDJ7E0qldJhUzcWs3mNOpcyqlFllVqXMKrMqZbbuylEO/J3qrPjfqrLio8Ao94yUs+JUnfcaIS98MAIAadIb0yuztZTLig9cIyvOlVnxkNkcEVEPVlFwEdePiDwAadItb5XZWsplxe+8Rlace5D+92Bj8VAjAHlAmojI7Smaa3NMK7PKbA3VW8qKlxKMnu12WXFgjPcGzJY3Fl9BD1AsLLQDSFNbdZZcmVVma2wNpsqKXyxlxR+4N82vMjNzuLF4Jw0gR+0BnSMjD5fKbpQcuZ76WWW2lhrO8QCGeZd3R+5qWXEOs+LUEjiKdmCEiOwI9yDagRyNYMTBupr03gbKbE3XDVyGcTkzM4/m7KiNjbis+AO8N5yDeUyjADxuA+DtBYCHaI9H7QN2hPeWmd0LAA9ThwKrzNZOK5j5zuGKDW9HqzcWD7PiS0qGdpSoHRi5A+h1zJamZI7ZETc9Uymzta2zSVdnX8jZ0Ukbi48hx3u9xQDgtb1Le+G9A3i0B/A6XJ312vGeY3ZkL3opSXuUWGW21sz+rKLOVmzSHON70jwGL4JRN0Nr+SXtWtkCABwBvI6ByHGqqLNLaDc4MrqalVhltpbMvhYfno7Z3ADSPJbjPUBXG5DmvTnahTT9v4dGemkPvI6ByKs0AK8jqLOUQ4zewzDFFFlltobMVmfFRy1ztuQNgDS/wvcBGKEOpFuQCzxr+/BSwAsKrNeBXhrBe7THeQa8R3FlVpmtlXp4AJGQ3BdiQVY8jqDYIs33hlnxvQDQVToJBngdAOKA1xGlGODF8V5wPuE47VZmldl5r5de+rMyO5Pav9/39+9XsGrJbCKRSP1emZ3BKuv79a+0iSnlkuLX0YpfXW4X78mtqk2+y+2rvNMN/2aJqkaVkgfOKrMzokHf9/1sYzCbqB7vqtZUnNywJkB6TWTj1/ObXbVVgWwyeXRYmZ2xQvuZfoHX2Bsk/m1IvcGMMqtc1ZbZVz7ROdhM6le+r1MwVVMxe8b3dc9xVVMxq+uzqqZjdr8yq2oyZv98XIdJVU9mfb/yrEDjtlJOSddKBnKtcAlzrraq/9qgJ1I32oPK7Cwxm1Jmg47w5y+zKpUyq1JmVSplVqVSZlUqZValzKpUyqxKpcyqlFmVSplVqZRZlTKrUimzKpUyq1JmVSplVqVSZlXzRv8fGeATnZaz4mIAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDYtMTFUMDg6MDI6MTkrMDA6MDC/SnEuAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTA2LTExVDA4OjAyOjE5KzAwOjAwzhfJkgAAAABJRU5ErkJggg==" alt="">
另外， OSPF 使用的是<strong>可靠的洪泛法</strong>发送更新分组</li> <li>优缺点
<ul><li>当互联网规模很大时，OSPF 协议要比 RIP 协议好得多</li> <li>OSPF 没有坏消息传得慢的问题，收敛比较快</li></ul></li></ul> <h4 id="_4-3-3-边界网关协议-bgp"><a href="#_4-3-3-边界网关协议-bgp" class="header-anchor">#</a> 4.3.3 边界网关协议 BGP</h4> <ul><li><p>使用环境</p> <p>不同 AS 间的路由选择协议</p> <blockquote><p>为什么不能使用内部网关协议（RIP/OSPF）？</p> <ul><li>互联网规模太大，使得自治系统 AS 之间的路由选择非常困难（交换完整信息需要庞大数据库，计算最短路径需花费大量时间），因此 BGP 协议使用交换“可达性”信息</li> <li>自治系统 AS 之间的路由选择必须考虑有关策略（考虑到政治、安全、经济等因素）</li></ul> <p>综合上述理由， BGP 只能是力求寻找一条<strong>能够到达目的网络且比较好的路由</strong>（不能兜圈子），而<strong>并非要寻找一条最佳路由</strong></p></blockquote></li> <li><p>BGP 发言人</p> <p>每个 AS 至少有一个 BGP 发言人（BGP speaker）</p></li> <li><p>交换路由信息</p> <p>BGP 发言人之间建立 TCP 连接，从而交换路由信息</p></li> <li><p>BGP 协议的特点</p> <ul><li>BGP 协议交换路由信息的节点数量级是自治系统数的量级，这要比这些自治系统中的网络数少很多</li> <li>每一个自治系统中 BGP 发言人（或边界路由器）的数目是很少的，这样就使得自治系统之间的路由选择不致过分复杂</li> <li>BGP 支持 CIDR</li> <li>在 BGP 刚刚运行时，BGP 的邻站是交换整个的 BGP 路由表。但以后<strong>只需要在发生变化时更新有变化的部分</strong>，这样做对节省网络带宽和减少路由器的处理开销都有好处</li></ul></li> <li><p>BGP-4 的四种报文</p> <ul><li>OPEN</li> <li>UPDATE</li> <li>KEEPALIVE</li> <li>NOTIFICATION</li></ul></li></ul> <h3 id="_4-4-地址解析协议-arp"><a href="#_4-4-地址解析协议-arp" class="header-anchor">#</a> 4.4 地址解析协议 ARP</h3> <p>用于解决<strong>同一个局域网</strong>上的主机或路由器的 IP 地址和硬件地址的映射问题</p> <div class="custom-block tip"><p class="custom-block-title">为什么要解析？</p> <ul><li>直接使用 MAC 地址通讯不可以嘛？</li> <li>因为网络发展初期，硬件地址格式并不统一</li></ul> <hr> <ul><li>IP 数据报里只能看到 IP 地址，在实际链路上传输还是需要使用硬件地址，所以在 IP 数据报封装成帧之前，需要知道目的节点的硬件地址，这是需要解析的</li> <li>IP 数据报在被路由器转发时，其数据链路层封装所使用的 MAC 地址是不断改变的</li></ul></div> <h4 id="_4-4-1-工作原理"><a href="#_4-4-1-工作原理" class="header-anchor">#</a> 4.4.1 工作原理</h4> <p>源节点喊（请求，广播帧）一下 IP x.x.x.x 的是谁，目的节点把他的 MAC 地址反馈（应答，单播即可）过去</p> <p>同时每台主机都有一个 ARP 高速缓存，称为 ARP 表，需要使用 ARP 来动态维护该表</p> <h4 id="_4-4-2-工作层次"><a href="#_4-4-2-工作层次" class="header-anchor">#</a> 4.4.2 工作层次</h4> <p>ARP 是为网络层服务的，但是 ARP 只经过链路层，不经过网络层封装</p> <h3 id="_4-5-网际控制报文协议-icmp"><a href="#_4-5-网际控制报文协议-icmp" class="header-anchor">#</a> 4.5 网际控制报文协议 ICMP</h3> <p>用来提高交付成功的机会，它允许主机或路由器报告差错情况和提供有关异常情况的报告</p> <h4 id="_4-5-1-icmp-的种类"><a href="#_4-5-1-icmp-的种类" class="header-anchor">#</a> 4.5.1 ICMP 的种类</h4> <ul><li><p>ICMP 差错报告报文（单独出现） 收到有问题的报文的主机或路由器向源主机或路由器发送</p> <ul><li>终点不可达</li> <li>源点抑制</li> <li>时间超过</li> <li>参数问题</li> <li>改变路由（重定向）</li></ul> <div class="custom-block tip"><p class="custom-block-title">不应发送 ICMP 差错报告报文的几种情况</p> <ul><li>对 ICMP 差错报告报文不应再发送 ICMP 差错报告报文</li> <li>对第一个分片的数据报片的所有后续数据报片都不发送 ICMP 差错报告报文</li> <li>对具有组播地址的数据报都不应发送 ICMP 差错报告报文</li> <li>对具有特殊地质的数据报不发送 ICMP 差错报告报文</li></ul></div></li> <li><p>ICMP 询问报文（成对出现）</p> <ul><li>回送请求和回答</li> <li>时间戳请求和回答</li></ul></li></ul> <h4 id="_4-5-2-icmp-应用举例"><a href="#_4-5-2-icmp-应用举例" class="header-anchor">#</a> 4.5.2 ICMP 应用举例</h4> <ul><li><code>ping</code> 用来测试两台主机之间的连通性</li> <li><code>traceroute</code>(*nix) 、 <code>tracert</code>(Windows) 用来跟踪分组经过的路由</li></ul> <h3 id="_4-6-ipv6"><a href="#_4-6-ipv6" class="header-anchor">#</a> 4.6 IPv6</h3> <p>IPv4 的 32 位地址空间已经不足，IPv6 的 128 位地址空间在可预见的未来是用不尽的</p> <h4 id="_4-6-1-ipv6-的主要特点"><a href="#_4-6-1-ipv6-的主要特点" class="header-anchor">#</a> 4.6.1 IPv6 的主要特点</h4> <p>仍支持无连接的传送</p> <p>主要变化：</p> <ul><li>更大的地址空间（<code>32bit -&gt; 128bit</code>）</li> <li>扩展的地址层次结构</li> <li>灵活的首部格式</li> <li>改进的选项</li> <li>允许协议继续扩充</li> <li>支持即插即用（即自动配置）</li> <li>支持资源的预分配</li> <li>IPv6 首部改为 8 字节对齐</li></ul> <h4 id="_4-6-2-ipv6-的地址"><a href="#_4-6-2-ipv6-的地址" class="header-anchor">#</a> 4.6.2 IPv6 的地址</h4> <ul><li><p>IPv6 的数据报的目的地址可以是以下三种基本类型地址之一</p> <ul><li>单播</li> <li>多播</li> <li>任播</li></ul></li> <li><p>IPv6 的记法（冒号十六进制记法）：</p> <ul><li>零压缩（只能进行一次）</li> <li>点分十进制法的后缀</li></ul></li></ul> <h4 id="_4-6-3-ipv4-向-ipv6-的过渡"><a href="#_4-6-3-ipv4-向-ipv6-的过渡" class="header-anchor">#</a> 4.6.3 IPv4 向 IPv6 的过渡</h4> <p>逐步演进</p> <ul><li>双协议栈 部分主机（或路由器）同时装有两个协议栈（IPv4、IPv6）</li> <li>隧道技术 当 IPv6 数据报进入 IPv4 网络时，将数据报封装成 IPv4 数据报</li></ul> <h4 id="_4-6-4-icmpv6"><a href="#_4-6-4-icmpv6" class="header-anchor">#</a> 4.6.4 ICMPv6</h4> <p>相当于 IPv4 中的 ICMP、IGMP、ARP 的合并版，其为面向报文的协议，利用报文来报告差错、获取信息</p> <h3 id="_4-7-ip-多播"><a href="#_4-7-ip-多播" class="header-anchor">#</a> 4.7 IP 多播</h3> <p>IP 多播，也称 IP 组播，可以更好地支持一对多通信（向 90 个主机发送数据需要 90 次单播，如果多播只需要一次）</p> <p>由于 TCP 是一对一的，所以多播一定是应用于 UDP 的</p> <h4 id="_4-7-1-网际组管理协议-igmp"><a href="#_4-7-1-网际组管理协议-igmp" class="header-anchor">#</a> 4.7.1 网际组管理协议 IGMP</h4> <p>使路由器知道多播组成员的信息</p> <ul><li><p>加入多播组</p> <p>主机向多播组的多播地址发送 IGMP 报文</p></li> <li><p>探询组成员变化情况</p> <p>多播路由器周期探询本地局域网上的主机，以便知道他们是否还活跃</p></li></ul> <h4 id="_4-7-2-多播路由选择协议"><a href="#_4-7-2-多播路由选择协议" class="header-anchor">#</a> 4.7.2 多播路由选择协议</h4> <p>使路由器和互联网上的其他多播路由器协同工作，以便多播数据报用最小代价传送给所有的组成员</p> <p>多播路由选择实际上就是要找出以源主机为根节点的多播转发树</p> <ul><li>洪泛与剪除</li> <li>隧道技术 在不支持多播的网络上加上首部重新封装后传输</li> <li>基于核心的发现技术</li></ul> <h3 id="_4-8-移动-ip"><a href="#_4-8-移动-ip" class="header-anchor">#</a> 4.8 移动 IP</h3> <h4 id="_4-8-1-移动-ip-的概念"><a href="#_4-8-1-移动-ip-的概念" class="header-anchor">#</a> 4.8.1 移动 IP 的概念</h4> <p>支持移动性的因特网体系结构与协议共称为移动 IP，使用移动 IP ，一个移动结点可以在不改变其 IP 地址的情况下改变其驻留位置</p> <p>三种功能实体</p> <ul><li>移动结点</li> <li>本地代理 移动结点永久“居所”（归属网络）中代表移动结点执行移动管理功能的实体</li> <li>外部代理 外部网络帮助移动结点完成管理功能的实体</li></ul> <div class="custom-block tip"><p class="custom-block-title">移动 IP 与动态 IP 的区别</p> <p>动态 IP 是指局域网中的计算机可通过 DHCP 服务器动态的获得 IP</p></div> <h4 id="_4-8-2-移动-ip-通信过程"><a href="#_4-8-2-移动-ip-通信过程" class="header-anchor">#</a> 4.8.2 移动 IP 通信过程</h4> <ul><li>移动结点在本地网时，按传统的 TCP/IP 方式通信</li> <li>移动结点<strong>漫游</strong>到一个外地网络时，仍然使用固定的 IP 地址进行通信，移动结点会在本地代理那里<strong>注册</strong>一个当前位置的地址，称为<strong>转交地址</strong></li> <li>移动结点<strong>收取</strong>信息需要通过<strong>本地代理</strong>向转交地址通过隧道封装转发</li> <li>移动结点<strong>发送</strong>信息需要通过<strong>外部代理</strong>发送</li> <li>移动结点<strong>更换</strong>外网时，只需要向本地代理<strong>更新</strong>转交地址即可</li> <li>移动结点<strong>回到</strong>本地网时，需要向本地代理<strong>注销</strong>转交地址</li></ul> <h3 id="_4-9-多协议标记交换-mpls"><a href="#_4-9-多协议标记交换-mpls" class="header-anchor">#</a> 4.9 多协议标记交换 MPLS</h3> <h4 id="_4-9-1-mpls-的工作原理"><a href="#_4-9-1-mpls-的工作原理" class="header-anchor">#</a> 4.9.1 MPLS 的工作原理</h4> <p>由于每次分组到达一个路由器后都需要抽取目的地址、查路由表后转发，所以当网络流量很大时会花费很多时间，故在 MPLS 域入口处给每个数据报打上一定长度的“标记”，之后<strong>对打上标记的 IP 数据报使用硬件进行转发</strong>，离开 MPLS 域时去掉标记</p> <h4 id="_4-9-2-mpls-首部的位置与格式"><a href="#_4-9-2-mpls-首部的位置与格式" class="header-anchor">#</a> 4.9.2 MPLS 首部的位置与格式</h4> <p>位置在网络层与数据链路层之间，从层次的角度看，MPLS 在第二层和第三层之间</p> <h3 id="_4-10-网络层设备"><a href="#_4-10-网络层设备" class="header-anchor">#</a> 4.10 网络层设备</h3> <h4 id="_4-10-1-路由器的结构"><a href="#_4-10-1-路由器的结构" class="header-anchor">#</a> 4.10.1 路由器的结构</h4> <ul><li>路由选择部分
<ul><li>路由选择处理机</li></ul></li> <li>分组转发部分
<ul><li>交换结构</li> <li>一组输出端口</li> <li>一组输出端口</li></ul></li></ul> <h4 id="_4-10-2-输入到输出"><a href="#_4-10-2-输入到输出" class="header-anchor">#</a> 4.10.2 输入到输出</h4> <p>打碎，重构网络层首部；相对的，网桥并不打碎链路层首位部</p> <ul><li>分组丢弃问题
<ul><li>当输入侧带宽较高时，路由器处理速率较低，将会导致输入侧缓存满，无法继续存入分组，只能丢弃</li> <li>当采用一定的加速比时，输出侧处理速度无法与输出侧处理速度相匹配，输出侧缓存满，也会导致分组被丢弃</li></ul></li></ul> <h4 id="_4-10-3-路由选择"><a href="#_4-10-3-路由选择" class="header-anchor">#</a> 4.10.3 路由选择</h4> <p>根据路由选择算法得出路由表，标准路由表含以下四个字段</p> <ul><li>目的网络 IP 地址</li> <li>子网掩码</li> <li>下一跳 IP 地址</li> <li>接口</li></ul> <h4 id="_4-10-3-交换结构"><a href="#_4-10-3-交换结构" class="header-anchor">#</a> 4.10.3 交换结构</h4> <p>将分组从一个输入端口转移到正确的输出端口</p> <ul><li>内存读写 需要解决内存读写速度</li> <li>总线结构 需要解决总线的竞争</li> <li>互联网络 crossbar 可多个端口同时输出</li></ul> <h2 id="_5-运输层"><a href="#_5-运输层" class="header-anchor">#</a> 5 运输层</h2> <ul><li>运输层为相互通信的 <mark>应用进程</mark> 提供逻辑通信</li> <li>TCP 面向连接， UDP 无连接</li> <li>差错检测</li></ul> <h3 id="_5-1-运输层协议概述"><a href="#_5-1-运输层协议概述" class="header-anchor">#</a> 5.1 运输层协议概述</h3> <h4 id="_5-1-1-进程之间的通信"><a href="#_5-1-1-进程之间的通信" class="header-anchor">#</a> 5.1.1 进程之间的通信</h4> <p><img src="/assets/img/CN03.e3b7810e.png" alt=""></p> <p>运输层向它上面的应用层提供通信服务，它属于<strong>面向通信部分的最高层，同时也是用户功能的最底层</strong></p> <p>值得注意的是，只有网络边缘的主机的协议栈才有运输层，网络核心部分的路由器只到网络层，所以在运输层来看，就像主机与主机之间直接的通讯，但是……</p> <p>端到端的通信其实是是应用进程之间的通信，并不是主机之间的</p> <h4 id="_5-1-2-基于端口的复用与分用"><a href="#_5-1-2-基于端口的复用与分用" class="header-anchor">#</a> 5.1.2 基于端口的复用与分用</h4> <p><img src="/assets/img/CN04.75624c47.png" alt=""></p> <ul><li>发送方不同的应用进程的数据都可以封装在运输层协议中，使用端口号进行标识，此称为<strong>复用</strong></li> <li>接收方的运输层能够根据端口号将这些数据正确交付给目的应用进程，此称为<strong>分用</strong></li></ul> <h4 id="_5-1-3-两个主要协议"><a href="#_5-1-3-两个主要协议" class="header-anchor">#</a> 5.1.3 两个主要协议</h4> <ul><li>传输控制协议 TCP
<ul><li>面向连接</li> <li>全双工可靠信道</li> <li>适用于可靠性更重要的场合</li> <li>传输单位： TCP 报文段</li></ul></li> <li>用户数据报协议 UDP
<ul><li>无连接</li> <li>不可靠信道</li> <li>执行速度较快、实时性好</li> <li>传输单位： UDP 用户数据报</li></ul></li></ul> <blockquote><p>一些网络层协议与运输层协议的对应关系
<img src="/assets/img/CN05.e4794b1e.png" alt=""></p></blockquote> <h4 id="_5-1-4-运输层的端口"><a href="#_5-1-4-运输层的端口" class="header-anchor">#</a> 5.1.4 运输层的端口</h4> <blockquote><p>这里的端口指的是软件端口</p></blockquote> <p>由于我们在运输层完成的是进程之间的通信，那么应用层所完成的主机之间的通信就显得不够了，这就需要我们在运输层协议首部加上各个进程的一个代号，这个任务就由端口号（软件端口）来完成了，当然，头部里源端口号和目的端口号都要写上，具体关系可参考 5.1.2 下的图</p> <p>用 16 位端口号来标志一个端口，也就是每台主机有 65535 个端口，当然这对一台计算机来说是够用的</p> <ul><li><p>端口号的分类</p> <ul><li>服务器使用的端口号
<ul><li>熟知端口号 0~1023</li> <li>系统端口号 1024~49151</li></ul></li> <li>客户端使用的端口号
又称<strong>短暂端口号</strong>，客户端程序以某端口号向服务器发送消息，服务器收到消息后向该端口号返回响应，通信结束后该端口便不再占用，可由其他进程使用</li></ul></li> <li><p>主要应用层协议的熟知端口号</p></li></ul> <p>UDP：</p> <table><thead><tr><th>端口号</th> <th>服务进程</th> <th>说明</th></tr></thead> <tbody><tr><td>53</td> <td>DNS</td> <td>域名服务</td></tr> <tr><td>67/68</td> <td>DHCP</td> <td>动态主机配置协议</td></tr> <tr><td>69</td> <td>TFTP</td> <td>简单文件传送协议</td></tr> <tr><td>80</td> <td>HTTP/3.0</td> <td>HTTP over QUIC</td></tr> <tr><td>111</td> <td>RPC</td> <td>远程过程调用</td></tr> <tr><td>123</td> <td>NTP</td> <td>网络时间协议</td></tr> <tr><td>161/162</td> <td>SNMP</td> <td>简单网络管理协议</td></tr></tbody></table> <p>TCP：</p> <table><thead><tr><th>端口号</th> <th>服务进程</th> <th>说明</th></tr></thead> <tbody><tr><td>20</td> <td>FTP</td> <td>文件传输协议（数据连接）</td></tr> <tr><td>21</td> <td>FTP</td> <td>文件传输协议（控制连接）</td></tr> <tr><td>23</td> <td>TELNET</td> <td>网络虚拟终端协议</td></tr> <tr><td>25</td> <td>SMTP</td> <td>简单邮件传输协议</td></tr> <tr><td>80</td> <td>HTTP/1.0、HTTP/1.1、HTTP/2</td> <td>超文本传输协议</td></tr> <tr><td>179</td> <td>BGP</td> <td>边际网关协议</td></tr> <tr><td>443</td> <td>HTTPS</td> <td>HTTP over SSL</td></tr></tbody></table> <h3 id="_5-2-用户数据报协议-udp"><a href="#_5-2-用户数据报协议-udp" class="header-anchor">#</a> 5.2 用户数据报协议 UDP</h3> <h4 id="_5-2-1-udp-概述"><a href="#_5-2-1-udp-概述" class="header-anchor">#</a> 5.2.1 UDP 概述</h4> <p>考虑一种最简单的方式，就是直接将 IP 数据报向上交付，但是由于运输层必须要完成复用和分用的任务，所以它一定是需要加一点点东西的。</p> <p>事实上 UDP 也只是在 IP 数据报服务的基础上增加了很少的内容。</p> <p><img src="/assets/img/CN06.44eac583.png" alt=""></p> <p>如图所示，它只增加了源端口号和目的端口号来完成复用和分用功能，此外还增加了长度和检验和，以提供简单的差错检测功能。</p> <p>值得注意的是，在计算检验和时需要连同一个伪首部一同计算。但这个<strong>伪首部只在计算检验和的时候使用，既不向上递交，也不向下传送</strong>。</p> <p>虽然 UDP 提供了差错检测的功能，但却对差错恢复无能为力，大多数情况下只会将差错信息作为警告发送给应用层的程序。</p> <p>另外，UDP 中计算检验和的时候<strong>首部和数据部分</strong>都检验，IP 数据报只检验其首部。</p> <p>此外，UDP 并不进行合并或者拆分，应用层数据添加首部后直接交付到网络层，这就导致了在 IP 层是很可能分片的，但是要注意的是，因为是分片所以会将整个 UDP 报文段作为数据负载进行切分，也就是只有第一片有 UDP 首部，后续片中无 UDP 首部。而 TCP 由于在建立三次握手时就会交换 MSS，因此数据可以保证在发送前在运输层分好段，交由 IP 层，当然此时每个 IP 数据报都拥有 TCP 首部。</p> <h4 id="_5-2-2-udp-的特点"><a href="#_5-2-2-udp-的特点" class="header-anchor">#</a> 5.2.2 UDP 的特点</h4> <ul><li>无连接</li> <li>尽最大努力交付（不保证可靠）</li> <li>面向报文（每个应用层报文加个首部就可以作为网络层的数据了，不对应用层报文拆分和合并，每个应用层报文对应一个 UDP 用户数据报）</li> <li>没有拥塞控制（不会因为网络的拥塞而降低源主机的发送速率，很适合实时应用）</li> <li>支持一对一、一对多、多对一和多对多的交互通信</li> <li>UDP 的首部开销小</li></ul> <p>当然，既然不可靠就一定会有对策，这就需要应用进程本身增加些提高可靠性的措施（应该就是应用层的事了，也就是我们需要考虑的问题了）。</p> <h3 id="_5-3-传输控制协议-tcp-概述"><a href="#_5-3-传输控制协议-tcp-概述" class="header-anchor">#</a> 5.3 传输控制协议 TCP 概述</h3> <h4 id="_5-3-1-tcp-最主要的特点"><a href="#_5-3-1-tcp-最主要的特点" class="header-anchor">#</a> 5.3.1 TCP 最主要的特点</h4> <ul><li>面向连接（以建立确保数据传输的参数，连接时会初始化各种 TCP 状态变量）</li> <li><strong>点对点</strong>（每一条 TCP 连接只能有两个端点）</li> <li>可靠交付（无差错、不丢失、不重复）</li> <li>全双工（两端都有<strong>缓存</strong>，两端应用程序只需要向各自缓存内读写数据即可，其他由 TCP 完成）</li> <li>面向字节流（TCP 将数据看作一连串无结构的字节流）</li></ul> <h4 id="_5-3-2-tcp-的连接"><a href="#_5-3-2-tcp-的连接" class="header-anchor">#</a> 5.3.2 TCP 的连接</h4> <p>TCP 连接的端点是套接字 Socket</p> <p>Socket = <code>IP : port</code></p> <p>如 106.14.169.129:1017</p> <h4 id="_5-3-3-tcp-报文段的首部格式"><a href="#_5-3-3-tcp-报文段的首部格式" class="header-anchor">#</a> 5.3.3 TCP 报文段的首部格式</h4> <p><img src="/assets/img/CN08.1bda067d.png" alt=""></p> <p>20Bytes 固定首部，最多 60Bytes。</p> <ul><li>源端口</li> <li>目的端口</li> <li>序号
<ul><li>所发送数据第一个字节的序号（比如某个分组序号为 301 ，长度 100 bytes，那么下一个分组序号就是 401）</li> <li>初始序号为双方各自随机产生的，并以字节编码</li></ul></li> <li>确认号（期待的下一个分组序号，比如接收到了 301 分组，长度 100 bytes，那么期待 401）
<blockquote><p>若确认号 = N，则表明：到序号 N-1 位置的所有数据都已正确收到</p></blockquote></li> <li>报头长度（数据偏移）以 4 字节为单元，比如 24Bytes 的报文段首部，该字段应为 6。</li> <li>保留</li> <li>6bits 状态位
<ul><li>紧急 URG</li> <li>确认 ACK</li> <li>推送 PSH</li> <li>复位 RST</li> <li>同步 SYN</li> <li>终止 FIN</li></ul></li> <li>窗口（与流量控制相关）</li> <li>检验和</li> <li>紧急指针</li> <li>选项（MSS 需要写在这里）</li></ul> <h3 id="_5-4-可靠传输的工作原理"><a href="#_5-4-可靠传输的工作原理" class="header-anchor">#</a> 5.4 可靠传输的工作原理</h3> <p>理想传输：</p> <ul><li>传输信道不产生差错</li> <li>不管发送方以多快的速度发送数据，接收方总是来得及处理收到的数据</li></ul> <p>但是理想是不可能的，所以我们就需要采取一些措施：</p> <ul><li>出现差错时让发送方重传出现差错的数据</li> <li>在接收方来不及处理收到的数据时，及时告诉发送方适当降低发送数据的速度</li></ul> <blockquote><p>如果在协议中，发送方在准备下一个数据项目之前先等待一个肯定的确认，则这样的协议称为 PAR（Positive Acknowledgement with Retransmission，支持重传的肯定确认协议）或者 ARQ（Automatic Repeat Request，自动重复请求协议）
—— 百度百科</p></blockquote> <ul><li>滑动窗口的重要特性
<ul><li>只有接收窗口向前滑动，发送窗口才有可能向前滑动</li> <li>三种协议的窗口大小对比
<ul><li>停止-等待协议： 发送窗口大小 = 1，接收窗口大小 = 1</li> <li>后退 N 帧协议： 发送窗口大小 &gt; 1，接收窗口大小 = 1（累计确认）</li> <li>选择重传协议： 发送窗口大小 &gt; 1，接收窗口大小 &gt; 1（逐个确认）</li></ul></li> <li>接收窗口的大小为 1 时，可保证帧的有序接收</li> <li>数据链路层的滑动窗口协议中，窗口的大小在传输过程中是固定的（区别于传输层）</li></ul></li></ul> <h4 id="_5-4-1-停止等待-arq-协议"><a href="#_5-4-1-停止等待-arq-协议" class="header-anchor">#</a> 5.4.1 停止等待 ARQ 协议</h4> <p>发送方每发送一个分组就停止发送，等待接收方返回确认，收到确认后才传下一个分组</p> <p>发送方对每个分组有一个超时计时器，若<strong>计时时间内未收到分组则重传</strong></p> <ul><li><p>确认丢失</p> <p>接收方向发送方发送的确认丢失了，那么发送方必然会重传，然后接收方又收到重复的分组，则丢弃，然后再次发送确认</p></li> <li><p>确认迟到</p> <p>接收方向发送方发送的确认迟到了，发送方当然也会重传啦，然后接收方又收到重复的分组，然后丢弃，发送方也会因此收到两个确认，其中一个就不管啦，反正已经确认过啦</p></li></ul> <p>很明显，这种方法信道利用率很低，每个分组都要等待返回确认才能继续下一组的发送，因此可利用流水线运输来提高信道利用率</p> <ul><li>特点
<ul><li>停止等待</li> <li>编号</li> <li>自动重传请求</li> <li>简单，但信道利用率太低</li></ul></li></ul> <h4 id="_5-4-2-连续-arq-协议"><a href="#_5-4-2-连续-arq-协议" class="header-anchor">#</a> 5.4.2 连续 ARQ 协议</h4> <p><img src="/assets/img/CN07.913ea97a.png" alt=""></p> <p>窗口内的可以发送，每收到确认，窗口向前滑动</p> <ul><li><p>累计确认
每次确认收到的最后一个分组即可</p> <ul><li><p>优点</p> <p>容易实现</p></li> <li><p>缺点</p> <p>可能出现回退的情况（Go-Back-N，简称 GBN ）</p></li></ul></li> <li><p>发送方接收方分别设有发送窗口和接收窗口</p></li> <li><p>发送方需要维护最早未确认报文段的计时器，如果计时器时间到，则重传所有未确认报文段</p></li></ul> <h4 id="_5-4-3-选择重传-arq-协议"><a href="#_5-4-3-选择重传-arq-协议" class="header-anchor">#</a> 5.4.3 选择重传 ARQ 协议</h4> <p>只重传差错的数据帧或计时器超时的数据帧，但此时必须加大接收窗口，以存储那些已经接收到但是不连续的数据</p> <p>当然，此时需要为每个未确认报文段都维护一个计时器</p> <h3 id="_5-5-tcp-可靠传输的实现"><a href="#_5-5-tcp-可靠传输的实现" class="header-anchor">#</a> 5.5 TCP 可靠传输的实现</h3> <h4 id="_5-5-1-以字节为单位的滑动窗口"><a href="#_5-5-1-以字节为单位的滑动窗口" class="header-anchor">#</a> 5.5.1 以字节为单位的滑动窗口</h4> <p><img src="/assets/img/CN09.f3ae0fba.png" alt=""></p> <p>发送端可以像连续 ARQ 协议一样连续发送，只需要接收到累计确认就好。</p> <p>接收端像选择重传 ARQ 协议一样可以接收未按序到达的包，但是是累计确认，所以需要有一定的推迟时间。</p> <p>发送方窗口是由接收方所发来的确认报文段（确认号 + 窗口）所构建的。</p> <h4 id="_5-5-2-超时重传时间的选择"><a href="#_5-5-2-超时重传时间的选择" class="header-anchor">#</a> 5.5.2 超时重传时间的选择</h4> <p>根据报文段的往返时间 RTT 来计算，这里使用滑动平均值</p> <p><span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>×</mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo>+</mo><mi>α</mi><mo>×</mo><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">RTT_S = (1 - \alpha) \times RTT_S + \alpha \times RTT</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></span></p> <p>另外设置超时重传时间 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi><mo>=</mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub><mo>+</mo><mn>4</mn><mo>×</mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">RTO = RTT_S + 4 \times RTT_D</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p> <p>这里 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">RTT_D</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 是偏差的滑动平均值……</p> <p>另外，值得注意的是当出现出现重传的情况下可能出现一个问题就是，收到的确认到底是对哪次发送的确认，如果认为是第一次，<span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">RTT_S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 会偏大，那么之后重传时间会变大，如果发生此情况比较多， <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">RTT_S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 就会持续增大，反之， <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">RTT_S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 减小，会导致重传次数增加，<span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>S</mi></msub></mrow><annotation encoding="application/x-tex">RTT_S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> 持续减小</p> <p>一种比较好的算法是，当出现重传的时候，<span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi></mrow><annotation encoding="application/x-tex">RTO</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span></span> 都变大些（通常取两倍）</p> <h4 id="_5-5-3-选择确认-sack"><a href="#_5-5-3-选择确认-sack" class="header-anchor">#</a> 5.5.3 选择确认 SACK</h4> <p>收到的字节块不连续，确认的时候增加该字段（在首部选项中）可防止发送方把某些已经收到的字节块重传</p> <h3 id="_5-6-tcp-的流量控制"><a href="#_5-6-tcp-的流量控制" class="header-anchor">#</a> 5.6 TCP 的流量控制</h3> <h4 id="_5-6-1-利用滑动窗口实现流量控制"><a href="#_5-6-1-利用滑动窗口实现流量控制" class="header-anchor">#</a> 5.6.1 利用滑动窗口实现流量控制</h4> <p><img src="/assets/img/CN10.1dbe48a6.png" alt=""></p> <p>利用滑动窗口可以很容易的实现流量控制</p> <p>另外要注意的就是死锁（接收端有了新的空间，提出新的可接受窗口，但不幸的是此消息丢失，两端都傻等着），可利用持续计时器解决</p> <h4 id="_5-6-2-tcp-的传输效率"><a href="#_5-6-2-tcp-的传输效率" class="header-anchor">#</a> 5.6.2 TCP 的传输效率</h4> <ul><li>当发送数据较少，数据部分就占得较少，利用率较低</li> <li>接收方刚空出来缓存空间就让接收方扩大窗口，可能扩大的量并不多，发送方只能发很少的数据</li></ul> <p>前者可用 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>a</mi><mi>g</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">Nagle</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">e</span></span></span></span></span> 优化，后者可让接收方等待一段时间再确认（养肥了再……）</p> <h3 id="_5-7-tcp-的拥塞控制"><a href="#_5-7-tcp-的拥塞控制" class="header-anchor">#</a> 5.7 TCP 的拥塞控制</h3> <p>流量控制是针对接收端缓存满的情况，而拥塞控制是针对整个网络上的主机和路由器缓存满的情况</p> <h4 id="_5-7-1-拥塞控制的一般原理"><a href="#_5-7-1-拥塞控制的一般原理" class="header-anchor">#</a> 5.7.1 拥塞控制的一般原理</h4> <p>出现拥塞的原因： <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span></span></span></span></span> 对资源的需求 &gt; 可用资源</p> <p>发送方需要维护以下两个窗口</p> <ul><li>接收窗口 rwnd</li> <li>拥塞窗口 cwnd</li></ul> <p>而发送窗口应取两者中较小值，即 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>r</mi><mi>w</mi><mi>n</mi><mi>d</mi><mo separator="true">,</mo><mi>c</mi><mi>w</mi><mi>n</mi><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(rwnd, cwnd)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span></span></p> <p>发送方可以根据超时来预测拥塞，而接收方可以通过发送重复确认来报告拥塞。</p> <h4 id="_5-7-2-tcp-的拥塞控制方法"><a href="#_5-7-2-tcp-的拥塞控制方法" class="header-anchor">#</a> 5.7.2 TCP 的拥塞控制方法</h4> <p>cwnd 初始值为 1（单位不是 Byte，是 SMSS）</p> <ul><li><p>慢开始和拥塞避免
<img src="/assets/img/CN22.126a16e2.png" alt="copyright:Wangdao"></p> <ul><li><p>慢开始</p> <p>起初 cwnd 成指数增长，直至其大小达到慢开始门限 ssthresh ，改用拥塞避免算法（宏观上每个传输轮次指数增长，实际上是通过每收到一个报文段的确认就 +1 来实现的）</p></li> <li><p>拥塞避免</p> <p>cwnd 成线性增长，如果出现超时，则 ssthresh 变为<strong>当前 cwnd</strong> 的一半，cwnd 重新置为 1</p></li></ul></li> <li><p>快重传和快恢复
<img src="/assets/img/CN23.0daf6553.png" alt="copyright:Wangdao"></p> <ul><li><p>快重传</p> <p>首先接收方要每收到一个<strong>失序的报文段</strong>后就立即发出重复确认。这样做可以让发送方及早知道有报文段没有到达接收方。发送方只要一连收到三个重复确认，就知道接收方确实没有收到报文段，因此应当立即进行重传，这样就不会出现超时，发送方也不就会误认为出现了网络拥塞</p></li> <li><p>快恢复</p> <p>当发送端收到连续三个重复的确认时，由于发送方现在认为网络很可能没有发生拥塞，因此现在不执行慢开始算法，而是执行快恢复算法</p> <p>执行快恢复算法算法时，cwnd 和 ssthresh 都变成当前 cwnd 的一半，并执行拥塞避免而非慢开始算法</p></li></ul></li></ul> <h4 id="_5-7-3-主动队列管理-aqm"><a href="#_5-7-3-主动队列管理-aqm" class="header-anchor">#</a> 5.7.3 主动队列管理 AQM <span class="badge tip" style="vertical-align:top;" data-v-78fb0d1c>~</span></h4> <p>如果路由器队列满了会将后来的丢失，而这些分组可能来自不同的 TCP 连接，这就使得网络上同时进入慢开始状态，之后又会同时增大通信量（全局同步）</p> <p>所以，应当在路由器队列尚未满的时候提早将部分分组丢失，其中一种实现方法是随机早期检测 RED</p> <h3 id="_5-8-tcp-的运输连接管理"><a href="#_5-8-tcp-的运输连接管理" class="header-anchor">#</a> 5.8 TCP 的运输连接管理</h3> <ul><li>连接建立</li> <li>数据传送</li> <li>连接释放</li></ul> <h4 id="_5-8-1-tcp-的连接建立"><a href="#_5-8-1-tcp-的连接建立" class="header-anchor">#</a> 5.8.1 TCP 的连接建立</h4> <p>三报文握手</p> <p><img src="/assets/img/CN12.5dd3229a.png" alt=""></p> <ul><li>客户端向服务器请求连接</li> <li>服务器发送同意连接</li> <li>客户端发送确认</li></ul> <h4 id="_5-8-2-tcp-的连接释放"><a href="#_5-8-2-tcp-的连接释放" class="header-anchor">#</a> 5.8.2 TCP 的连接释放</h4> <p>四报文握手</p> <p><img src="/assets/img/CN13.45b809ca.png" alt=""></p> <ul><li>客户端向服务器发送请求释放，进入<strong>半关闭</strong>状态</li> <li>服务器发送确认，并继续发送剩余数据</li> <li>服务器将剩余数据传输完后向客户端发送请求释放</li> <li>客户端发送确认</li></ul> <h2 id="_6-应用层"><a href="#_6-应用层" class="header-anchor">#</a> 6 应用层</h2> <p>每个应用层协议都是为了解决某一类应用问题，而问题的解决又往往是通过位于不同主机中的多个应用进程之间的通信和协同工作来完成的</p> <p>应用层的具体内容就是规定应用进程在通信时所遵循的协议</p> <h3 id="_6-1-域名系统-dns"><a href="#_6-1-域名系统-dns" class="header-anchor">#</a> 6.1 域名系统 DNS</h3> <h4 id="_6-1-1-域名系统概述"><a href="#_6-1-1-域名系统概述" class="header-anchor">#</a> 6.1.1 域名系统概述</h4> <p>用于解析域名与其对应的 IP 地址</p> <p>采用分布式的域名系统 DNS</p> <p>需要若干的域名服务器，DNS 解析报文使用 UDP 以减小开销</p> <p>而在多个 nameserver 之间迁移记录时则使用 TCP 来传输</p> <h4 id="_6-1-2-互联网的域名结构"><a href="#_6-1-2-互联网的域名结构" class="header-anchor">#</a> 6.1.2 互联网的域名结构</h4> <p>树状结构： n 级域名.<span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">⋯</span></span></span></span></span>.三级域名.二级域名.顶级域名</p> <ul><li>顶级域名分类
<ul><li>国家顶级域名 nTLD
<ul><li>us</li> <li>jp</li> <li>cn</li> <li>uk</li> <li><span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">⋯</span></span></span></span></span></li></ul></li> <li>通用顶级域名 gTLD
<ul><li>com</li> <li>net</li> <li>org</li> <li><span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">⋯</span></span></span></span></span></li></ul></li> <li>基础结构顶级域名 用于反向域名解析
<ul><li>arpa</li></ul></li></ul></li></ul> <h4 id="_6-1-3-域名服务器"><a href="#_6-1-3-域名服务器" class="header-anchor">#</a> 6.1.3 域名服务器</h4> <p>将域划分为区，每个区内一个域名服务器</p> <p>每个域名服务器都应建立缓存以提高查询效率</p> <ul><li><p>本地域名服务器</p> <p>客户端缓存如果没有对应域名，则向本地域名服务器查询（递归查询），本地服务器若没有对应缓存，则代为查询（迭代查询）</p></li> <li><p>根域名服务器</p> <p>本地域名服务器无法解析时首先求助于根域名服务器，当根域名服务器无法解析时，会告诉本地服务器应该向哪个顶级域名服务器查询</p> <p>使用任播技术</p></li> <li><p>顶级域名服务器（TLD 服务器）</p> <p>当顶级域名服务器仍无法解析该域名的时候，会告诉本地服务器应该向哪个权限域名服务器查询，依此迭代</p></li> <li><p>权限域名服务器</p> <p>就是各个区的域名服务器</p></li></ul> <p>具体查询过程可参加下图</p> <p><img src="/assets/img/CN15.999a4fde.png" alt=""></p> <h3 id="_6-2-文件传送协议"><a href="#_6-2-文件传送协议" class="header-anchor">#</a> 6.2 文件传送协议</h3> <h4 id="_6-2-1-ftp-概述"><a href="#_6-2-1-ftp-概述" class="header-anchor">#</a> 6.2.1 FTP 概述</h4> <p>存取、修改都需要先从服务器下载其副本，操作后重传</p> <h4 id="_6-2-2-ftp-的基本工作原理"><a href="#_6-2-2-ftp-的基本工作原理" class="header-anchor">#</a> 6.2.2 FTP 的基本工作原理</h4> <p>使用两个 TCP 连接（控制连接和数据连接）</p> <h4 id="_6-2-3-简单文件传送协议-tftp"><a href="#_6-2-3-简单文件传送协议-tftp" class="header-anchor">#</a> 6.2.3 简单文件传送协议 TFTP</h4> <p>使用 UDP ，简单</p> <h3 id="_6-3-远程终端协议-telnet"><a href="#_6-3-远程终端协议-telnet" class="header-anchor">#</a> 6.3 远程终端协议 TELNET <span class="badge tip" style="vertical-align:top;" data-v-78fb0d1c>~</span></h3> <p>利用 TCP ，用户好像直接连接到远程主机上，可以直接通过该协议操作远程主机（仅限命令）</p> <p>为了适应各系统的差异，所以命令需预先编码成 NVT 格式，然后在服务器解码后执行</p> <h3 id="_6-4-超文本传输协议-http"><a href="#_6-4-超文本传输协议-http" class="header-anchor">#</a> 6.4 超文本传输协议 HTTP</h3> <h4 id="_6-4-1-http-1-0"><a href="#_6-4-1-http-1-0" class="header-anchor">#</a> 6.4.1 HTTP/1.0</h4> <p>使用 TCP，无状态，非持续连接。</p> <p>非持续连接引发的问题：每个 Request 都需要建立一次 TCP 连接，这就需要三握手，前两次握手花费 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">RTT</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></span> 时间，第三次握手时同时发送 Request，加上服务器返回的 Response 又是一个 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">RTT</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></span>，一共需要花费 <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">RTT \times 2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span> 的时间。</p> <p>无状态的解决方案：Cookie，Server 在响应时加上 Set-cookie，以后 Client 每次都带上这个 Cookie。</p> <h4 id="_6-4-2-http-1-1"><a href="#_6-4-2-http-1-1" class="header-anchor">#</a> 6.4.2 HTTP/1.1</h4> <p>HTTP/1.1 引入了持续连接，多个请求可以复用同一条 TCP 连接。</p> <p>另外 HTTP/1.1 还支持非流水线和流水线方式的请求，流水线方式时，Client 可以无阻塞的连续发送多个请求。</p> <h4 id="_6-4-3-https"><a href="#_6-4-3-https" class="header-anchor">#</a> 6.4.3 HTTPS</h4> <p>也即 HTTP over SSL，当然现在主要使用的是 TLS 而非 SSL 了。熟知端口号为 443 而非 HTTP 的 80。</p> <h4 id="_6-4-4-http-2"><a href="#_6-4-4-http-2" class="header-anchor">#</a> 6.4.4 HTTP/2</h4> <p>虽然 HTTP/1.1 引入了 Pipelining 的方式，但那只是 Client 端可以连续请求，Server 端仍然需要按请求的顺序请求，该问题被称为“队头阻塞”。</p> <p>HTTP/2 首先引入了数据流的机制，每个请求或响应可能被分成多个帧，同一个请求或响应的多个帧使用同一个独一无二的编号来标识，在到达目的主机后重新组装。</p> <p>因为数据以流的方式发送，Server 端不必按照顺序进行响应，一定程度上解决了队头阻塞问题。</p> <p>另外，同一条连接是可以双工地复用的。</p> <p>不过要注意的是，HTTP/2 强制使用 HTTPS。</p> <h4 id="_6-4-5-http-3"><a href="#_6-4-5-http-3" class="header-anchor">#</a> 6.4.5 HTTP/3</h4> <p>虽然 HTTP/2 从应用层上解决了队头阻塞问题，但是受制于底层 TCP 的可靠传输实现方式，阻塞问题是无法避免的，因此 HTTP/3 直接弃用了 TCP，转而使用 UDP 协议。</p> <p>HTTP/3 是基于 google 的 QUIC 协议的，而 QUIC 则是基于 UDP 的。</p> <h3 id="_6-5-电子邮件"><a href="#_6-5-电子邮件" class="header-anchor">#</a> 6.5 电子邮件</h3> <h4 id="_6-5-1-电子邮件概述"><a href="#_6-5-1-电子邮件概述" class="header-anchor">#</a> 6.5.1 电子邮件概述</h4> <p>使用 TCP</p> <h4 id="_6-5-2-简单邮件传送协议-smtp"><a href="#_6-5-2-简单邮件传送协议-smtp" class="header-anchor">#</a> 6.5.2 简单邮件传送协议 SMTP</h4> <h4 id="_6-5-3-电子邮件的信息格式"><a href="#_6-5-3-电子邮件的信息格式" class="header-anchor">#</a> 6.5.3 电子邮件的信息格式</h4> <p>首部</p> <ul><li>To</li> <li>Subject</li> <li>Cc</li> <li>From</li> <li>Date</li> <li>Reply-To</li></ul> <h4 id="_6-5-4-邮件读取协议-pop3-和-imap"><a href="#_6-5-4-邮件读取协议-pop3-和-imap" class="header-anchor">#</a> 6.5.4 邮件读取协议 POP3 和 IMAP</h4> <ul><li>邮局协议 POP （当前第三个版本 POP3）</li> <li>网际报文存取协议 IMAP （当前第四个版本 IMAP4，但通常直接称为 IMAP）</li></ul> <h4 id="_6-5-5-基于万维网的电子邮件"><a href="#_6-5-5-基于万维网的电子邮件" class="header-anchor">#</a> 6.5.5 基于万维网的电子邮件</h4> <p>用户使用 HTTP 协议与邮件服务器传送邮件，但邮件服务器之间仍使用 SMTP 传送</p> <h4 id="_6-5-6-通用互联网邮件扩充-mime"><a href="#_6-5-6-通用互联网邮件扩充-mime" class="header-anchor">#</a> 6.5.6 通用互联网邮件扩充 MIME</h4> <p>因为 SMTP 只能传输 ASCII 码（每个 7bit）的数据，所以传输其它数据需要经过编码，转换成 ASCII 码再传输</p> <p>比如针对二进制数据的 base64 编码（每 6bit 转换成一个 ASCII 码）</p> <h3 id="_6-6-动态主机配置协议-dhcp"><a href="#_6-6-动态主机配置协议-dhcp" class="header-anchor">#</a> 6.6 动态主机配置协议 DHCP</h3> <p>为了免去为需要连接网络的设备逐个配置 IP 、子网掩码等信息的麻烦，DHCP 应运而生</p> <ul><li>即插即用，非常适合经常变换网络的设备</li> <li>使用 UDP，通过广播与 DHCP 服务器交互，因为这时候连 IP 都没有，无法建立 TCP 连接</li> <li>每个网络使用一个 DHCP 中继代理，以降低 DHCP 服务器的数量</li> <li>IP 是有租用期的，当租用期过了一半需请求更新租用期</li></ul> <h3 id="_6-7-简单网络管理协议-snmp"><a href="#_6-7-简单网络管理协议-snmp" class="header-anchor">#</a> 6.7 简单网络管理协议 SNMP <span class="badge tip" style="vertical-align:top;" data-v-78fb0d1c>~</span></h3> <p>网络管理包裹对硬件、软件和人力的使用、综合与协调，以便对网络自言进行监视、测试、配置、分析、评价和控制，这样就能以合理的价格满足网络的一些需求，如实时运行性能、服务质量等</p> <p>其包含了</p> <ul><li>SNMP 本身</li> <li>管理信息结构 SMI</li> <li>管理信息库 MIB</li></ul> <h3 id="_6-8-应用进程跨越网络的通信"><a href="#_6-8-应用进程跨越网络的通信" class="header-anchor">#</a> 6.8 应用进程跨越网络的通信 <span class="badge tip" style="vertical-align:top;" data-v-78fb0d1c>~</span></h3> <p>系统调用 （system call）
应用编程接口 API （Application Programming Interface）</p> <p><img src="/assets/img/CN16.a6d17888.png" alt=""></p> <p>当然，UDP 服务器由于只提供无连接服务，因此不适用 listen 和 accept 系统调用</p> <h3 id="_6-9-p2p-应用"><a href="#_6-9-p2p-应用" class="header-anchor">#</a> 6.9 P2P 应用</h3> <p>资源并不存储在服务器上，服务器上只存储资源的索引，资源存储在用户主机上</p> <h2 id="_7-网络安全"><a href="#_7-网络安全" class="header-anchor">#</a> 7 网络安全 <span class="badge tip" style="vertical-align:top;" data-v-78fb0d1c>~</span></h2> <h3 id="_7-1-网络安全问题概述"><a href="#_7-1-网络安全问题概述" class="header-anchor">#</a> 7.1 网络安全问题概述</h3> <h4 id="_7-1-1-计算机网络面临的安全性威胁"><a href="#_7-1-1-计算机网络面临的安全性威胁" class="header-anchor">#</a> 7.1.1 计算机网络面临的安全性威胁</h4> <ul><li>被动攻击
<ul><li>截获</li></ul></li> <li>主动攻击
<ul><li>篡改</li> <li>恶意程序
<ul><li>计算机病毒</li> <li>计算机蠕虫</li> <li>特洛伊木马</li> <li>逻辑炸弹</li> <li>后门入侵</li> <li>流氓软件</li></ul></li> <li>拒绝服务</li></ul></li></ul> <h4 id="_7-1-2-安全的计算机网络"><a href="#_7-1-2-安全的计算机网络" class="header-anchor">#</a> 7.1.2 安全的计算机网络</h4> <ul><li>保密性</li> <li>端点鉴别</li> <li>信息的完整性</li> <li>运行的安全性</li></ul> <h4 id="_7-1-3-数据加密模型"><a href="#_7-1-3-数据加密模型" class="header-anchor">#</a> 7.1.3 数据加密模型</h4> <ul><li>密钥 K</li> <li>加密 E</li> <li>解密 D</li> <li><span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>E</mi><mi>K</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y = E_K(X)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span></span></li> <li><span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>K</mi></msub><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>D</mi><mi>K</mi></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mi>K</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">D_K(Y) = D_K(E_K(X)) = X</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span></span></li></ul> <h3 id="_7-2-两类密码机制"><a href="#_7-2-两类密码机制" class="header-anchor">#</a> 7.2 两类密码机制</h3> <h4 id="_7-2-1-对称密钥密码机制"><a href="#_7-2-1-对称密钥密码机制" class="header-anchor">#</a> 7.2.1 对称密钥密码机制</h4> <ul><li>数据加密标准 DES</li> <li>高级加密标准 AES</li></ul> <p>通信双方都要有该密钥，是一对一的双向保密通信</p> <h4 id="_7-2-2-公钥密码机制"><a href="#_7-2-2-公钥密码机制" class="header-anchor">#</a> 7.2.2 公钥密码机制</h4> <p>RSA 体制</p> <ul><li>公钥 PK 利用公钥加密数据，只有拥有私钥的用户才能解密</li> <li>私钥 SK</li></ul> <p>先利用公钥加密（E），后利用私钥解密（D）和先利用私钥 D 操作，再利用公钥 E 操作得到的结果都是一样的，都是原数据</p> <p><span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>P</mi><msub><mi>K</mi><mi>B</mi></msub></mrow></msub><mo stretchy="false">(</mo><msub><mi>D</mi><mrow><mi>S</mi><msub><mi>K</mi><mi>B</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><msub><mi>D</mi><mrow><mi>S</mi><msub><mi>K</mi><mi>B</mi></msub></mrow></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mrow><mi>P</mi><msub><mi>K</mi><mi>B</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">E_{PK_B}(D_{SK_B}(X)) = D_{SK_B}(E_{PK_B}(X)) = X</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.000305em;vertical-align:-0.250305em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.000305em;vertical-align:-0.250305em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.250305em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span></span></p> <p>公钥是公开的，是多对一的单向保密通信</p> <h3 id="_7-3-数字签名"><a href="#_7-3-数字签名" class="header-anchor">#</a> 7.3 数字签名</h3> <p>用于保证这个消息确实是这个发送方发的</p> <p>只需要发送方事先用私钥 D 一下数据，这样接收方试下用公钥 E 能不能获得明文数据就知道数据到底是不是该发送方发的了，因为只有发送方有私钥</p> <h3 id="_7-4-鉴别"><a href="#_7-4-鉴别" class="header-anchor">#</a> 7.4 鉴别</h3> <p>鉴别是要验证通信的对方的确是自己要所通信的对象，而不是其他的冒充者，并且所传送的报文是完整的，没有被他人篡改过</p> <h4 id="_7-4-1-报文鉴别"><a href="#_7-4-1-报文鉴别" class="header-anchor">#</a> 7.4.1 报文鉴别</h4> <ul><li><p>密码散列函数</p></li> <li><p>使用的密码散列函数 MD5 和 SHA-1</p></li> <li><p>报文鉴别码</p> <p>计算报文的 MD5 并加密，将其添加在报文后，由于第三方并不知道密钥，就无法在改变数据后重新计算 MD5 的加密值</p></li></ul> <h4 id="_7-4-2-实体鉴别"><a href="#_7-4-2-实体鉴别" class="header-anchor">#</a> 7.4.2 实体鉴别</h4> <p>在系统接入的全部持续时间内只鉴别一次</p> <p><strong>重放攻击</strong> ：直接把数据原封不动的传给目的地，可用不重数解决
<strong>中间人攻击</strong> ：向 B 发送数据时冒充 A，向 A 发送数据时冒充 B ，这使得 A 和 B 以为他们在直接通信，但是所有数据都被备份了一份</p> <h3 id="_7-5-密钥分配"><a href="#_7-5-密钥分配" class="header-anchor">#</a> 7.5 密钥分配</h3> <ol><li>对称密钥的分配</li></ol> <p>密钥分配中心 KDC</p> <ol start="2"><li>公钥的分配</li></ol> <p>认证中心 CA</p> <h3 id="_7-6-互联网所使用的安全协议"><a href="#_7-6-互联网所使用的安全协议" class="header-anchor">#</a> 7.6 互联网所使用的安全协议</h3> <h4 id="_7-6-1-网络层安全协议"><a href="#_7-6-1-网络层安全协议" class="header-anchor">#</a> 7.6.1 网络层安全协议</h4> <p>IPsec</p> <h4 id="_7-6-2-运输层安全协议"><a href="#_7-6-2-运输层安全协议" class="header-anchor">#</a> 7.6.2 运输层安全协议</h4> <ul><li>安全套接字层 SSL
<ul><li>使用 SSL 的 HTTPS 端口号是 443 ，而不是 HTTP 的 80</li></ul></li> <li>运输层安全 TLS</li></ul> <h4 id="_7-6-3-应用层安全协议"><a href="#_7-6-3-应用层安全协议" class="header-anchor">#</a> 7.6.3 应用层安全协议</h4> <p>这里以电子邮件为例</p> <p>PGP 协议，基于 MD5 和 RSA</p> <h3 id="_7-7-系统安全-防火墙与入侵检测"><a href="#_7-7-系统安全-防火墙与入侵检测" class="header-anchor">#</a> 7.7 系统安全：防火墙与入侵检测</h3> <h4 id="_7-7-1-防火墙"><a href="#_7-7-1-防火墙" class="header-anchor">#</a> 7.7.1 防火墙</h4> <p>防火墙是特殊编程的路由器，实施访问控制策略</p> <ul><li>分组过滤路由器</li> <li>应用网关，又称代理服务器</li></ul> <h4 id="_7-7-2-入侵检测系统-ids"><a href="#_7-7-2-入侵检测系统-ids" class="header-anchor">#</a> 7.7.2 入侵检测系统 IDS</h4> <p>用于检测多种网络攻击，并进行告警或阻断操作</p> <h3 id="_7-8-展望"><a href="#_7-8-展望" class="header-anchor">#</a> 7.8 展望</h3> <ul><li>椭圆曲线密码 ECC</li> <li>移动安全</li> <li>量子密码</li></ul> <h2 id="_8-互联网上的音频-视频服务"><a href="#_8-互联网上的音频-视频服务" class="header-anchor">#</a> 8 互联网上的音频/视频服务 <span class="badge tip" style="vertical-align:top;" data-v-78fb0d1c>~</span></h2> <h3 id="_8-1-概述"><a href="#_8-1-概述" class="header-anchor">#</a> 8.1 概述</h3> <p>多媒体信息在互联网上传输的一些问题</p> <ul><li>多媒体的信息的信息量往往很大</li> <li>在传输多媒体数据时，对时延和时延抖动均有较高的要求 （这就需要用到缓存）</li></ul> <p>三种类型</p> <ul><li>流式存储音频/视频 资源存储在服务器上</li> <li>流式实况音频/视频 资源是边录制边发送的</li> <li>交互式音频/视频 实时交互</li></ul> <blockquote><p>这里的流（streaming）与 flow 不同</p></blockquote> <h3 id="_8-2-流式存储音频-视频"><a href="#_8-2-流式存储音频-视频" class="header-anchor">#</a> 8.2 流式存储音频/视频</h3> <ul><li>使用元文件</li> <li>使用媒体服务器，以专门发送媒体数据</li> <li>实时流式协议 RTSP ， 与 HTTP 相类似，但是是有状态的，使用 TCP 或 UDP</li></ul> <h3 id="_8-3-交互式音频-视频"><a href="#_8-3-交互式音频-视频" class="header-anchor">#</a> 8.3 交互式音频/视频</h3> <ul><li>IP 电话</li> <li>实时运输协议 RTP</li> <li>实时运输控制协议 RTCP</li> <li>H.323</li> <li>会话发起协议 SIP</li></ul> <h3 id="_8-4-改进-尽最大努力交付-的服务"><a href="#_8-4-改进-尽最大努力交付-的服务" class="header-anchor">#</a> 8.4 改进“尽最大努力交付”的服务</h3> <ul><li>使互联网提供服务质量</li> <li>调度和管制机制
<ul><li>调度机制 公平排队、加权公平排队</li> <li>管制机制 漏桶管制器</li></ul></li> <li>综合服务 IntServ 与资源预留协议 RSVP</li> <li>区分服务 DiffServ</li></ul> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <ol><li>申彦明老师课程</li> <li><a href="http://yx.51zhy.cn/net.jsp" target="_blank" rel="noopener noreferrer">《计算机网络》及其配套课件 谢希仁<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>2020 年计算机网络考研复习指导 - 王道</li> <li>王宇新老师课程</li> <li>《计算机网络——自顶向下方法》</li></ol></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2019-09-18
    </span> <span class="update-date" data-v-4e23451f>
      Updated : Invalid Date
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2019/08/21/data-structures-and-algorithms.html" class="post-link" data-v-4e23451f>
      Previous Post : Data Structures and Algorthms
    </a> <a href="/posts/2019/10/04/c-to-plusplus.html" class="post-link" data-v-4e23451f>
      Next Post : C to ++
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/info-bg.jpg);" data-v-9d847660><img src="/avatar.jpg" alt="喵ック" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      喵ック
    </section> <section class="info-desc" data-v-9d847660>可爱是第一驱动力～</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="DLC, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>DLC, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          DLC, China
        </span></span></section> <section data-v-9d847660><span title="Dalian University of Technology" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Dalian University of Technology</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          Dalian University of Technology
        </span></span></section> <section data-v-9d847660><a href="mailto:sigure.qaq@gmail.com" title="sigure.qaq@gmail.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>sigure.qaq@gmail.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          sigure.qaq@gmail.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/SigureMo" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: SigureMo" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: SigureMo</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>Table of Contents</span> <div class="post-nav-toc"><ul><li><a href="/posts/2019/09/18/computer-network.html#_1-计算机网络体系结构">1 计算机网络体系结构</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_1-1-计算机网络概述">1.1 计算机网络概述</a></li><li><a href="/posts/2019/09/18/computer-network.html#_1-2-计算机网络的体系结构">1.2 计算机网络的体系结构</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#_2-物理层">2 物理层</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_2-1-通信基础">2.1 通信基础</a></li><li><a href="/posts/2019/09/18/computer-network.html#_2-2-传输介质">2.2 传输介质</a></li><li><a href="/posts/2019/09/18/computer-network.html#_2-3-交换技术">2.3 交换技术</a></li><li><a href="/posts/2019/09/18/computer-network.html#_2-4-数据编码技术">2.4 数据编码技术</a></li><li><a href="/posts/2019/09/18/computer-network.html#_2-5-基带传输技术">2.5 基带传输技术</a></li><li><a href="/posts/2019/09/18/computer-network.html#_2-6-多路复用技术">2.6 多路复用技术</a></li><li><a href="/posts/2019/09/18/computer-network.html#_2-7-物理层设备">2.7 物理层设备</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#_3-数据链路层">3 数据链路层</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_3-1-三个基本问题">3.1 三个基本问题</a></li><li><a href="/posts/2019/09/18/computer-network.html#_3-2-使用点对点信道的数据链路层">3.2 使用点对点信道的数据链路层</a></li><li><a href="/posts/2019/09/18/computer-network.html#_3-3-使用广播信道的数据链路层">3.3 使用广播信道的数据链路层</a></li><li><a href="/posts/2019/09/18/computer-network.html#_3-4-数据链路层设备">3.4 数据链路层设备</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#_4-网络层">4 网络层</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_4-1-网络层的功能">4.1 网络层的功能</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-2-网际协议-ip">4.2 网际协议 IP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-3-internet-的路由选择协议">4.3 Internet 的路由选择协议</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-4-地址解析协议-arp">4.4 地址解析协议 ARP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-5-网际控制报文协议-icmp">4.5 网际控制报文协议 ICMP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-6-ipv6">4.6 IPv6</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-7-ip-多播">4.7 IP 多播</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-8-移动-ip">4.8 移动 IP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-9-多协议标记交换-mpls">4.9 多协议标记交换 MPLS</a></li><li><a href="/posts/2019/09/18/computer-network.html#_4-10-网络层设备">4.10 网络层设备</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#_5-运输层">5 运输层</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_5-1-运输层协议概述">5.1 运输层协议概述</a></li><li><a href="/posts/2019/09/18/computer-network.html#_5-2-用户数据报协议-udp">5.2 用户数据报协议 UDP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_5-3-传输控制协议-tcp-概述">5.3 传输控制协议 TCP 概述</a></li><li><a href="/posts/2019/09/18/computer-network.html#_5-4-可靠传输的工作原理">5.4 可靠传输的工作原理</a></li><li><a href="/posts/2019/09/18/computer-network.html#_5-5-tcp-可靠传输的实现">5.5 TCP 可靠传输的实现</a></li><li><a href="/posts/2019/09/18/computer-network.html#_5-6-tcp-的流量控制">5.6 TCP 的流量控制</a></li><li><a href="/posts/2019/09/18/computer-network.html#_5-7-tcp-的拥塞控制">5.7 TCP 的拥塞控制</a></li><li><a href="/posts/2019/09/18/computer-network.html#_5-8-tcp-的运输连接管理">5.8 TCP 的运输连接管理</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#_6-应用层">6 应用层</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_6-1-域名系统-dns">6.1 域名系统 DNS</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-2-文件传送协议">6.2 文件传送协议</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-3-远程终端协议-telnet">6.3 远程终端协议 TELNET</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-4-超文本传输协议-http">6.4 超文本传输协议 HTTP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-5-电子邮件">6.5 电子邮件</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-6-动态主机配置协议-dhcp">6.6 动态主机配置协议 DHCP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-7-简单网络管理协议-snmp">6.7 简单网络管理协议 SNMP</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-8-应用进程跨越网络的通信">6.8 应用进程跨越网络的通信</a></li><li><a href="/posts/2019/09/18/computer-network.html#_6-9-p2p-应用">6.9 P2P 应用</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#_7-网络安全">7 网络安全</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_7-1-网络安全问题概述">7.1 网络安全问题概述</a></li><li><a href="/posts/2019/09/18/computer-network.html#_7-2-两类密码机制">7.2 两类密码机制</a></li><li><a href="/posts/2019/09/18/computer-network.html#_7-3-数字签名">7.3 数字签名</a></li><li><a href="/posts/2019/09/18/computer-network.html#_7-4-鉴别">7.4 鉴别</a></li><li><a href="/posts/2019/09/18/computer-network.html#_7-5-密钥分配">7.5 密钥分配</a></li><li><a href="/posts/2019/09/18/computer-network.html#_7-6-互联网所使用的安全协议">7.6 互联网所使用的安全协议</a></li><li><a href="/posts/2019/09/18/computer-network.html#_7-7-系统安全-防火墙与入侵检测">7.7 系统安全：防火墙与入侵检测</a></li><li><a href="/posts/2019/09/18/computer-network.html#_7-8-展望">7.8 展望</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#_8-互联网上的音频-视频服务">8 互联网上的音频/视频服务</a><ul><li><a href="/posts/2019/09/18/computer-network.html#_8-1-概述">8.1 概述</a></li><li><a href="/posts/2019/09/18/computer-network.html#_8-2-流式存储音频-视频">8.2 流式存储音频/视频</a></li><li><a href="/posts/2019/09/18/computer-network.html#_8-3-交互式音频-视频">8.3 交互式音频/视频</a></li><li><a href="/posts/2019/09/18/computer-network.html#_8-4-改进-尽最大努力交付-的服务">8.4 改进“尽最大努力交付”的服务</a></li></ul></li><li><a href="/posts/2019/09/18/computer-network.html#references">References</a></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2019/09/18/computer-network.html#post-comments">
      Comments
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/SigureMo" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: SigureMo" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: SigureMo</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <p class="footer-text" data-v-1375e54c><span data-v-1375e54c>Powered by </span> <a href="https://github.com/vuejs/vuepress" target="_blank" data-v-1375e54c>
      VuePress
    </a> <span data-v-1375e54c> | </span> <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank" data-v-1375e54c>
        meteorlxy
      </a></p> <p class="footer-text" data-v-1375e54c>Copyright 2018-present <a href="https://github.com/SigureMo" target="_blank">Nyakku</a> | <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA-4.0</a></p></footer></div><div class="global-ui"><!----><!----><!----><canvas id="vuepress-canvas-ribbon"></canvas><canvas id="vuepress-canvas-cursor"></canvas><div></div><div id="goTop" class="hide-cat" data-v-bf92849a></div><APlayer audio="" fixed="true" theme="#b7daff" loop="loop" order="list" preload="auto" volume="0.7" mutex="true" lrc-type="3" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer></div></div>
    <script src="/assets/js/app.03ef6dba.js" defer></script><script src="/assets/js/19.5df00096.js" defer></script><script src="/assets/js/8.b1bbf589.js" defer></script><script src="/assets/js/20.770d2159.js" defer></script><script src="/assets/js/17.6e32e58c.js" defer></script>
  </body>
</html>
